// ==UserScript==
// @name        IITC plugin: Data Explorer
// @description UI to explore intel available data
// @namespace   https://github.com/le-jeu
// @version     0.1.3
// @match       https://intel.ingress.com/*
// @author      jaiperdu
// @updateURL   https://github.com/le-jeu/iitc-data-explorer/raw/dist/dataExplorer.user.js
// @downloadURL https://github.com/le-jeu/iitc-data-explorer/raw/dist/dataExplorer.user.js
// @grant       none
// ==/UserScript==

function wrapper(plugin_info) {
// ensure plugin framework is there, even if iitc is not yet loaded
if(typeof window.plugin !== 'function') window.plugin = function() {};

var cssList = [];
function registerCSS(css) {
	cssList.push(css);
}

function addCSS(css) {
	var s = document.createElement('style');
	s.textContent = css;
	document.head.appendChild(s);
}

function addCSSs(css) {
	cssList.forEach(addCSS);
}
var setup=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function r(t,e,n,o){if(t){const i=a(t,e,n,o);return t[0](i)}}function a(t,e,n,o){return t[1]&&o?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](o(e))):n.ctx}function c(t,e,n,o){if(t[2]&&o){const i=t[2](o(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|i[o];return t}return e.dirty|i}return e.dirty}function d(t,e,n,o,i,s){if(i){const l=a(e,n,o,s);t.p(l,i)}}function u(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function p(t,e,n){return t.set(n),e}function f(t,e){t.appendChild(e)}function g(t,e,n){t.insertBefore(e,n||null)}function $(t){t.parentNode.removeChild(t)}function m(t){return document.createElement(t)}function v(t){return document.createTextNode(t)}function h(){return v(" ")}function w(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function x(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function k(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function y(t,e,n){t.classList[n?"add":"remove"](e)}let b;function D(t){b=t}function I(){if(!b)throw new Error("Function called outside component initialization");return b}function E(){const t=I();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const i=function(t,e,n=!1){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,n,!1,e),o}(e,n);o.slice().forEach((e=>{e.call(t,i)}))}}}function C(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const S=[],z=[],q=[],_=[],O=Promise.resolve();let L=!1;function j(t){q.push(t)}let G=!1;const M=new Set;function P(){if(!G){G=!0;do{for(let t=0;t<S.length;t+=1){const e=S[t];D(e),T(e.$$)}for(D(null),S.length=0;z.length;)z.pop()();for(let t=0;t<q.length;t+=1){const e=q[t];M.has(e)||(M.add(e),e())}q.length=0}while(S.length);for(;_.length;)_.pop()();L=!1,G=!1,M.clear()}}function T(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}const A=new Set;let F;function N(){F={r:0,c:[],p:F}}function U(){F.r||o(F.c),F=F.p}function H(t,e){t&&t.i&&(A.delete(t),t.i(e))}function B(t,e,n,o){if(t&&t.o){if(A.has(t))return;A.add(t),F.c.push((()=>{A.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function J(t,e){t.d(1),e.delete(t.key)}function R(t,e,n,o,i,s,l,r,a,c,d,u){let p=t.length,f=s.length,g=p;const $={};for(;g--;)$[t[g].key]=g;const m=[],v=new Map,h=new Map;for(g=f;g--;){const t=u(i,s,g),r=n(t);let a=l.get(r);a?o&&a.p(t,e):(a=c(r,t),a.c()),v.set(r,m[g]=a),r in $&&h.set(r,Math.abs(g-$[r]))}const w=new Set,x=new Set;function k(t){H(t,1),t.m(r,d),l.set(t.key,t),d=t.first,f--}for(;p&&f;){const e=m[f-1],n=t[p-1],o=e.key,i=n.key;e===n?(d=e.first,p--,f--):v.has(i)?!l.has(o)||w.has(o)?k(e):x.has(i)?p--:h.get(o)>h.get(i)?(x.add(o),k(e)):(w.add(i),p--):(a(n,l),p--)}for(;p--;){const e=t[p];v.has(e.key)||a(e,l)}for(;f;)k(m[f-1]);return m}function Y(t){t&&t.c()}function Z(t,n,s,l){const{fragment:r,on_mount:a,on_destroy:c,after_update:d}=t.$$;r&&r.m(n,s),l||j((()=>{const n=a.map(e).filter(i);c?c.push(...n):o(n),t.$$.on_mount=[]})),d.forEach(j)}function K(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Q(t,e){-1===t.$$.dirty[0]&&(S.push(t),L||(L=!0,O.then(P)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function V(e,i,s,l,r,a,c,d=[-1]){const u=b;D(e);const p=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:r,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(u?u.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:i.target||u.$$.root};c&&c(p.root);let f=!1;if(p.ctx=s?s(e,i.props||{},((t,n,...o)=>{const i=o.length?o[0]:n;return p.ctx&&r(p.ctx[t],p.ctx[t]=i)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](i),f&&Q(e,t)),n})):[],p.update(),f=!0,o(p.before_update),p.fragment=!!l&&l(p.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);p.fragment&&p.fragment.l(t),t.forEach($)}else p.fragment&&p.fragment.c();i.intro&&H(e.$$.fragment),Z(e,i.target,i.anchor,i.customElement),P()}D(u)}class W{$destroy(){K(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function X(t){let e,n;const o=t[3].default,i=r(o,t,t[2],null);return{c(){e=m("div"),i&&i.c()},m(o,s){g(o,e,s),i&&i.m(e,null),t[4](e),n=!0},p(t,[e]){i&&i.p&&(!n||4&e)&&d(i,o,t,t[2],n?c(o,t[2],e,null):u(t[2]),null)},i(t){n||(H(i,t),n=!0)},o(t){B(i,t),n=!1},d(n){n&&$(e),i&&i.d(n),t[4](null)}}}function tt(t,e,n){let o,{$$slots:i={},$$scope:s}=e,{options:l={}}=e;var r;return r=()=>{dialog(Object.assign(l,{html:o}))},I().$$.on_mount.push(r),t.$$set=t=>{"options"in t&&n(1,l=t.options),"$$scope"in t&&n(2,s=t.$$scope)},[o,l,s,i,function(t){z[t?"unshift":"push"]((()=>{o=t,n(0,o)}))}]}class et extends W{constructor(t){super(),V(this,t,tt,X,s,{options:1})}}const nt=[];function ot(e,n=t){let o;const i=new Set;function l(t){if(s(e,t)&&(e=t,o)){const t=!nt.length;for(const t of i)t[1](),nt.push(t,e);if(t){for(let t=0;t<nt.length;t+=2)nt[t][0](nt[t+1]);nt.length=0}}}return{set:l,update:function(t){l(t(e))},subscribe:function(s,r=t){const a=[s,r];return i.add(a),1===i.size&&(o=n(l)||t),s(e),()=>{i.delete(a),0===i.size&&(o(),o=null)}}}}const it=ot({}),st=ot({}),lt=ot({}),rt=ot(null);function at(t,e,n){const o=t.slice();return o[3]=e[n][0],o[4]=e[n][1],o}registerCSS(".grid.svelte-nryyad{display:grid;grid-template-columns:max-content auto;grid-gap:4px;font-family:monospace}.grid.svelte-nryyad>div{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:30em}");const ct=t=>({key:1&t}),dt=t=>({key:t[3]}),ut=t=>({key:1&t}),pt=t=>({key:t[3]});function ft(t){let e,n;const o=t[2].key,i=r(o,t,t[1],pt),s=i||function(t){let e,n,o=t[3]+"";return{c(){e=m("div"),n=v(o)},m(t,o){g(t,e,o),f(e,n)},p(t,e){1&e&&o!==(o=t[3]+"")&&k(n,o)},d(t){t&&$(e)}}}(t),l=t[2].value,a=r(l,t,t[1],dt),p=a||function(t){let e,n,o,i,s=t[4]+"";return{c(){e=m("div"),n=v(s),i=h(),x(e,"title",o=t[4])},m(t,o){g(t,e,o),f(e,n),g(t,i,o)},p(t,i){1&i&&s!==(s=t[4]+"")&&k(n,s),1&i&&o!==(o=t[4])&&x(e,"title",o)},d(t){t&&$(e),t&&$(i)}}}(t);return{c(){s&&s.c(),e=h(),p&&p.c()},m(t,o){s&&s.m(t,o),g(t,e,o),p&&p.m(t,o),n=!0},p(t,e){i?i.p&&(!n||3&e)&&d(i,o,t,t[1],n?c(o,t[1],e,ut):u(t[1]),pt):s&&s.p&&(!n||1&e)&&s.p(t,n?e:-1),a?a.p&&(!n||3&e)&&d(a,l,t,t[1],n?c(l,t[1],e,ct):u(t[1]),dt):p&&p.p&&(!n||1&e)&&p.p(t,n?e:-1)},i(t){n||(H(s,t),H(p,t),n=!0)},o(t){B(s,t),B(p,t),n=!1},d(t){s&&s.d(t),t&&$(e),p&&p.d(t)}}}function gt(t){let e,n,o=Object.entries(t[0]),i=[];for(let e=0;e<o.length;e+=1)i[e]=ft(at(t,o,e));const s=t=>B(i[t],1,1,(()=>{i[t]=null}));return{c(){e=m("div");for(let t=0;t<i.length;t+=1)i[t].c();x(e,"class","grid svelte-nryyad")},m(t,o){g(t,e,o);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,[n]){if(3&n){let l;for(o=Object.entries(t[0]),l=0;l<o.length;l+=1){const s=at(t,o,l);i[l]?(i[l].p(s,n),H(i[l],1)):(i[l]=ft(s),i[l].c(),H(i[l],1),i[l].m(e,null))}for(N(),l=o.length;l<i.length;l+=1)s(l);U()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)H(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)B(i[t]);n=!1},d(t){t&&$(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(i,t)}}}function $t(t,e,n){let{$$slots:o={},$$scope:i}=e,{properties:s={}}=e;return t.$$set=t=>{"properties"in t&&n(0,s=t.properties),"$$scope"in t&&n(1,i=t.$$scope)},[s,i,o]}class mt extends W{constructor(t){super(),V(this,t,$t,gt,s,{properties:0})}}function vt(t,e){return!!window.fields[e]&&window.fields[e].options.data.points.some((e=>e.guid==t))}function ht(t,e){return!!window.links[e]&&(window.links[e].options.data.oGuid==t||window.links[e].options.data.dGuid==t)}function wt(t,e){const n=window.links[t];return!!n&&(vt(n.options.data.oGuid,e)&&vt(n.options.data.dGuid,e))}function xt(t){const e=new Date(t),n=e.getUTCFullYear()+"",o=e.getUTCMonth()+1+"",i=e.getUTCDate()+"",s=e.getUTCHours()+"",l=e.getUTCMinutes()+"",r=e.getUTCSeconds()+"",a=e.getUTCMilliseconds()+"";return`${n}-${o.padStart(2,"0")}-${i.padStart(2,"0")}T${s.padStart(2,"0")}:${l.padStart(2,"0")}:${r.padStart(2,"0")}.${a.padStart(3,"0")}Z`}function kt(t,e,n){const o=t.slice();return o[8]=e[n],o}function yt(t,e){let n,o,i,s,l,r,a,c,d=e[8]+"",u=xt(e[2][e[8]].options.timestamp)+"";function p(){return e[6](e[8])}return{key:t,first:null,c(){n=m("div"),o=v(d),i=h(),s=m("div"),l=v(u),r=h(),x(n,"class","raw svelte-okcb76"),y(n,"active",e[8]==e[0]),x(s,"class","raw date svelte-okcb76"),y(s,"active",e[8]==e[0]),this.first=n},m(t,e){g(t,n,e),f(n,o),g(t,i,e),g(t,s,e),f(s,l),f(s,r),a||(c=w(n,"click",p),a=!0)},p(t,i){e=t,2&i&&d!==(d=e[8]+"")&&k(o,d),3&i&&y(n,"active",e[8]==e[0]),6&i&&u!==(u=xt(e[2][e[8]].options.timestamp)+"")&&k(l,u),3&i&&y(s,"active",e[8]==e[0])},d(t){t&&$(n),t&&$(i),t&&$(s),a=!1,c()}}}function bt(e){let n,o=[],i=new Map,s=e[1];const l=t=>t[8];for(let t=0;t<s.length;t+=1){let n=kt(e,s,t),r=l(n);i.set(r,o[t]=yt(r,n))}return{c(){n=m("div");for(let t=0;t<o.length;t+=1)o[t].c();x(n,"class","grid svelte-okcb76")},m(t,e){g(t,n,e);for(let t=0;t<o.length;t+=1)o[t].m(n,null)},p(t,[e]){15&e&&(s=t[1],o=R(o,e,l,1,t,s,i,n,J,yt,null,kt))},i:t,o:t,d(t){t&&$(n);for(let t=0;t<o.length;t+=1)o[t].d()}}}function Dt(t,e,n){let o;l(t,st,(t=>n(2,o=t)));const i=E();let{portalID:s=null}=e,{activeID:r=!1}=e,{fieldID:a=null}=e,c=[];function d(t){i("select",{type:"link",guid:t})}return t.$$set=t=>{"portalID"in t&&n(4,s=t.portalID),"activeID"in t&&n(0,r=t.activeID),"fieldID"in t&&n(5,a=t.fieldID)},t.$$.update=()=>{52&t.$$.dirty&&n(1,c=Object.keys(o).filter((t=>(!s||ht(s,t))&&(!a||wt(t,a))))),54&t.$$.dirty&&(n(1,c=Object.keys(o).filter((t=>(!s||ht(s,t))&&(!a||wt(t,a))))),c.sort(((t,e)=>o[e].options.timestamp-o[t].options.timestamp)))},[r,c,o,d,s,a,t=>d(t)]}registerCSS(".grid.svelte-okcb76.svelte-okcb76{display:grid;grid-template-columns:auto max-content;grid-gap:4px;font-family:monospace}.grid.svelte-okcb76 div.svelte-okcb76{white-space:nowrap;max-width:30em}.date.svelte-okcb76.svelte-okcb76{margin-left:auto}.active.svelte-okcb76.svelte-okcb76{color:green}");class It extends W{constructor(t){super(),V(this,t,Dt,bt,s,{portalID:4,activeID:0,fieldID:5})}}function Et(t,e,n){const o=t.slice();return o[8]=e[n],o}function Ct(t,e){let n,o,i,s,l,r,a,c,d=e[8]+"",u=xt(e[2][e[8]].options.timestamp)+"";function p(){return e[6](e[8])}return{key:t,first:null,c(){n=m("div"),o=v(d),i=h(),s=m("div"),l=v(u),r=h(),x(n,"class","svelte-okcb76"),y(n,"active",e[8]==e[0]),x(s,"class","date svelte-okcb76"),y(s,"active",e[8]==e[0]),this.first=n},m(t,e){g(t,n,e),f(n,o),g(t,i,e),g(t,s,e),f(s,l),f(s,r),a||(c=w(n,"click",p),a=!0)},p(t,i){e=t,2&i&&d!==(d=e[8]+"")&&k(o,d),3&i&&y(n,"active",e[8]==e[0]),6&i&&u!==(u=xt(e[2][e[8]].options.timestamp)+"")&&k(l,u),3&i&&y(s,"active",e[8]==e[0])},d(t){t&&$(n),t&&$(i),t&&$(s),a=!1,c()}}}function St(e){let n,o=[],i=new Map,s=e[1];const l=t=>t[8];for(let t=0;t<s.length;t+=1){let n=Et(e,s,t),r=l(n);i.set(r,o[t]=Ct(r,n))}return{c(){n=m("div");for(let t=0;t<o.length;t+=1)o[t].c();x(n,"class","grid svelte-okcb76")},m(t,e){g(t,n,e);for(let t=0;t<o.length;t+=1)o[t].m(n,null)},p(t,[e]){15&e&&(s=t[1],o=R(o,e,l,1,t,s,i,n,J,Ct,null,Et))},i:t,o:t,d(t){t&&$(n);for(let t=0;t<o.length;t+=1)o[t].d()}}}function zt(t,e,n){let o;l(t,lt,(t=>n(2,o=t)));const i=E();let{portalID:s=null}=e,{linkID:r=null}=e,{activeID:a=!1}=e,c=[];function d(t){i("select",{type:"field",guid:t})}return t.$$set=t=>{"portalID"in t&&n(4,s=t.portalID),"linkID"in t&&n(5,r=t.linkID),"activeID"in t&&n(0,a=t.activeID)},t.$$.update=()=>{54&t.$$.dirty&&(n(1,c=Object.keys(o).filter((t=>(!s||vt(s,t))&&(!r||wt(r,t))))),c.sort(((t,e)=>o[e].options.timestamp-o[t].options.timestamp)))},[a,c,o,d,s,r,t=>d(t)]}registerCSS(".grid.svelte-okcb76.svelte-okcb76{display:grid;grid-template-columns:auto max-content;grid-gap:4px;font-family:monospace}.grid.svelte-okcb76 div.svelte-okcb76{white-space:nowrap;max-width:30em}.date.svelte-okcb76.svelte-okcb76{margin-left:auto}.active.svelte-okcb76.svelte-okcb76{color:green}");class qt extends W{constructor(t){super(),V(this,t,zt,St,s,{portalID:4,linkID:5,activeID:0})}}function _t(t){let e,n,o,i,s,l,r,a,c,d,u,p,f,v;return o=new mt({props:{properties:t[3],$$slots:{value:[jt,({key:t})=>({8:t}),({key:t})=>t?256:0]},$$scope:{ctx:t}}}),r=new It({props:{portalID:t[0]}}),r.$on("select",t[6]),u=new qt({props:{portalID:t[0]}}),u.$on("select",t[7]),{c(){e=m("h3"),e.textContent="Portal ↻",n=h(),Y(o.$$.fragment),i=h(),s=m("h3"),s.textContent="Links",l=h(),Y(r.$$.fragment),a=h(),c=m("h3"),c.textContent="Fields",d=h(),Y(u.$$.fragment),x(e,"class","svelte-176lmyd"),x(s,"class","svelte-176lmyd"),x(c,"class","svelte-176lmyd")},m($,m){g($,e,m),g($,n,m),Z(o,$,m),g($,i,m),g($,s,m),g($,l,m),Z(r,$,m),g($,a,m),g($,c,m),g($,d,m),Z(u,$,m),p=!0,f||(v=w(e,"click",t[5]),f=!0)},p(t,e){const n={};8&e&&(n.properties=t[3]),780&e&&(n.$$scope={dirty:e,ctx:t}),o.$set(n);const i={};1&e&&(i.portalID=t[0]),r.$set(i);const s={};1&e&&(s.portalID=t[0]),u.$set(s)},i(t){p||(H(o.$$.fragment,t),H(r.$$.fragment,t),H(u.$$.fragment,t),p=!0)},o(t){B(o.$$.fragment,t),B(r.$$.fragment,t),B(u.$$.fragment,t),p=!1},d(t){t&&$(e),t&&$(n),K(o,t),t&&$(i),t&&$(s),t&&$(l),K(r,t),t&&$(a),t&&$(c),t&&$(d),K(u,t),f=!1,v()}}}function Ot(t){let e,n=t[3][t[8]]+"";return{c(){e=v(n)},m(t,n){g(t,e,n)},p(t,o){264&o&&n!==(n=t[3][t[8]]+"")&&k(e,n)},d(t){t&&$(e)}}}function Lt(t){let e,n,o,i=t[3][t[8]]+"";return{c(){e=m("a"),n=v(i),x(e,"href",o=t[3][t[8]])},m(t,o){g(t,e,o),f(e,n)},p(t,s){264&s&&i!==(i=t[3][t[8]]+"")&&k(n,i),264&s&&o!==(o=t[3][t[8]])&&x(e,"href",o)},d(t){t&&$(e)}}}function jt(t){let e,n;function o(t,e){return"image"==t[8]?Lt:Ot}let i=o(t),s=i(t);return{c(){e=m("div"),s.c(),x(e,"slot","value"),x(e,"title",n=t[2][t[8]]||t[3][t[8]])},m(t,n){g(t,e,n),s.m(e,null)},p(t,l){i===(i=o(t))&&s?s.p(t,l):(s.d(1),s=i(t),s&&(s.c(),s.m(e,null))),268&l&&n!==(n=t[2][t[8]]||t[3][t[8]])&&x(e,"title",n)},d(t){t&&$(e),s.d()}}}function Gt(t){let e,n,o=t[1]&&_t(t);return{c(){e=m("div"),o&&o.c()},m(t,i){g(t,e,i),o&&o.m(e,null),n=!0},p(t,[n]){t[1]?o?(o.p(t,n),2&n&&H(o,1)):(o=_t(t),o.c(),H(o,1),o.m(e,null)):o&&(N(),B(o,1,1,(()=>{o=null})),U())},i(t){n||(H(o),n=!0)},o(t){B(o),n=!1},d(t){t&&$(e),o&&o.d()}}}function Mt(t,e,n){let o,i,s;l(t,it,(t=>n(4,s=t)));let{guid:r=null}=e,a=null;return t.$$set=t=>{"guid"in t&&n(0,r=t.guid)},t.$$.update=()=>{17&t.$$.dirty&&(r&&s[r]?n(1,a=s[r]):n(1,a=null)),2&t.$$.dirty&&n(3,o=a?{guid:a.options.guid,timestamp:xt(a.options.timestamp),team:a.options.team,latE6:a.options.data.latE6,lngE6:a.options.data.lngE6,level:a.options.level,health:a.options.data.health,resCount:a.options.data.resCount,image:a.options.data.image,title:a.options.data.title,ornaments:a.options.data.ornaments,mission:a.options.data.mission,mission50plus:a.options.data.mission50plus,artifactBrief:JSON.stringify(a.options.data.artifactBrief),mods:JSON.stringify(a.options.data.mods),resonators:JSON.stringify(a.options.data.resonators),owner:a.options.data.owner,artifactDetail:JSON.stringify(a.options.data.artifactDetail),history:a.options.data.history&&a.options.data.history._raw||0}:{}),2&t.$$.dirty&&n(2,i=a?{image:'<img src="'+a.options.data.image+'" style="width: 100px; height=100px"/>'}:{})},[r,a,i,o,s,()=>window.renderPortalDetails(r),function(e){C.call(this,t,e)},function(e){C.call(this,t,e)}]}registerCSS("h3.svelte-176lmyd:hover{text-decoration:underline;cursor:pointer}");class Pt extends W{constructor(t){super(),V(this,t,Mt,Gt,s,{guid:0})}}function Tt(t,e,n){const o=t.slice();return o[9]=e[n],o}function At(t,e){let n,o,i,s,l,r,a,c,d,u=(e[2][e[9]].options.data.title||e[9])+"",p=xt(e[2][e[9]].options.timestamp)+"";function b(){return e[7](e[9])}return{key:t,first:null,c(){n=m("div"),o=v(u),s=h(),l=m("div"),r=v(p),a=h(),x(n,"title",i=e[9]),x(n,"class","svelte-1agsx3x"),y(n,"selected",e[9]==e[3]),y(n,"active",e[9]==e[0]),y(n,"raw",!e[2][e[9]].options.data.title),x(l,"class","raw date svelte-1agsx3x"),y(l,"selected",e[9]==e[3]),y(l,"active",e[9]==e[0]),this.first=n},m(t,e){g(t,n,e),f(n,o),g(t,s,e),g(t,l,e),f(l,r),f(l,a),c||(d=w(n,"click",b),c=!0)},p(t,s){e=t,6&s&&u!==(u=(e[2][e[9]].options.data.title||e[9])+"")&&k(o,u),2&s&&i!==(i=e[9])&&x(n,"title",i),10&s&&y(n,"selected",e[9]==e[3]),3&s&&y(n,"active",e[9]==e[0]),6&s&&y(n,"raw",!e[2][e[9]].options.data.title),6&s&&p!==(p=xt(e[2][e[9]].options.timestamp)+"")&&k(r,p),10&s&&y(l,"selected",e[9]==e[3]),3&s&&y(l,"active",e[9]==e[0])},d(t){t&&$(n),t&&$(s),t&&$(l),c=!1,d()}}}function Ft(e){let n,o=[],i=new Map,s=e[1];const l=t=>t[9];for(let t=0;t<s.length;t+=1){let n=Tt(e,s,t),r=l(n);i.set(r,o[t]=At(r,n))}return{c(){n=m("div");for(let t=0;t<o.length;t+=1)o[t].c();x(n,"class","grid svelte-1agsx3x")},m(t,e){g(t,n,e);for(let t=0;t<o.length;t+=1)o[t].m(n,null)},p(t,[e]){31&e&&(s=t[1],o=R(o,e,l,1,t,s,i,n,J,At,null,Tt))},i:t,o:t,d(t){t&&$(n);for(let t=0;t<o.length;t+=1)o[t].d()}}}function Nt(t,e,n){let o,i;l(t,it,(t=>n(2,o=t))),l(t,rt,(t=>n(3,i=t)));const s=E();let{activeID:r=!1}=e,{linkID:a=null}=e,{fieldID:c=null}=e,d=[];function u(t){s("select",{type:"portal",guid:t})}return t.$$set=t=>{"activeID"in t&&n(0,r=t.activeID),"linkID"in t&&n(5,a=t.linkID),"fieldID"in t&&n(6,c=t.fieldID)},t.$$.update=()=>{if(102&t.$$.dirty)if(a){const t=window.links[a];n(1,d=t?[t.options.data.oGuid,t.options.data.dGuid]:[])}else if(c){const t=window.fields[c];n(1,d=t?t.options.data.points.map((t=>t.guid)):[])}else n(1,d=Object.keys(o)),d.sort(((t,e)=>o[e].options.timestamp-o[t].options.timestamp))},[r,d,o,i,u,a,c,t=>u(t)]}registerCSS(".grid.svelte-1agsx3x.svelte-1agsx3x{display:grid;grid-template-columns:auto max-content;grid-gap:4px}.grid.svelte-1agsx3x div.svelte-1agsx3x:nth-child(2n + 1){text-overflow:ellipsis;overflow:hidden}.grid.svelte-1agsx3x div.svelte-1agsx3x{white-space:nowrap;max-width:30em}.grid.svelte-1agsx3x div.raw.svelte-1agsx3x{font-family:monospace}.date.svelte-1agsx3x.svelte-1agsx3x{margin-left:auto}.selected.svelte-1agsx3x.svelte-1agsx3x{color:red}.active.svelte-1agsx3x.svelte-1agsx3x{color:green}");class Ut extends W{constructor(t){super(),V(this,t,Nt,Ft,s,{activeID:0,linkID:5,fieldID:6})}}function Ht(t){let e,n,o,i,s,l,r,a,c,d,u,p;return o=new mt({props:{properties:t[2]}}),r=new Ut({props:{linkID:t[0]}}),r.$on("select",t[4]),u=new qt({props:{linkID:t[0]}}),u.$on("select",t[5]),{c(){e=m("h3"),e.textContent="Link",n=h(),Y(o.$$.fragment),i=h(),s=m("h3"),s.textContent="Portals",l=h(),Y(r.$$.fragment),a=h(),c=m("h3"),c.textContent="Fields",d=h(),Y(u.$$.fragment)},m(t,f){g(t,e,f),g(t,n,f),Z(o,t,f),g(t,i,f),g(t,s,f),g(t,l,f),Z(r,t,f),g(t,a,f),g(t,c,f),g(t,d,f),Z(u,t,f),p=!0},p(t,e){const n={};4&e&&(n.properties=t[2]),o.$set(n);const i={};1&e&&(i.linkID=t[0]),r.$set(i);const s={};1&e&&(s.linkID=t[0]),u.$set(s)},i(t){p||(H(o.$$.fragment,t),H(r.$$.fragment,t),H(u.$$.fragment,t),p=!0)},o(t){B(o.$$.fragment,t),B(r.$$.fragment,t),B(u.$$.fragment,t),p=!1},d(t){t&&$(e),t&&$(n),K(o,t),t&&$(i),t&&$(s),t&&$(l),K(r,t),t&&$(a),t&&$(c),t&&$(d),K(u,t)}}}function Bt(t){let e,n,o=t[1]&&Ht(t);return{c(){e=m("div"),o&&o.c()},m(t,i){g(t,e,i),o&&o.m(e,null),n=!0},p(t,[n]){t[1]?o?(o.p(t,n),2&n&&H(o,1)):(o=Ht(t),o.c(),H(o,1),o.m(e,null)):o&&(N(),B(o,1,1,(()=>{o=null})),U())},i(t){n||(H(o),n=!0)},o(t){B(o),n=!1},d(t){t&&$(e),o&&o.d()}}}function Jt(t,e,n){let o,i;l(t,st,(t=>n(3,i=t)));let{guid:s=null}=e,r=null;return t.$$set=t=>{"guid"in t&&n(0,s=t.guid)},t.$$.update=()=>{9&t.$$.dirty&&(s&&i[s]?n(1,r=i[s]):n(1,r=null)),2&t.$$.dirty&&n(2,o=r?{guid:r.options.guid,timestamp:xt(r.options.timestamp),team:r.options.team,oGuid:r.options.data.oGuid,oLatE6:r.options.data.oLatE6,oLngE6:r.options.data.oLngE6,dGuid:r.options.data.dGuid,dLatE6:r.options.data.dLatE6,dLngE6:r.options.data.dLngE6}:{})},[s,r,o,i,function(e){C.call(this,t,e)},function(e){C.call(this,t,e)}]}class Rt extends W{constructor(t){super(),V(this,t,Jt,Bt,s,{guid:0})}}function Yt(t){let e,n,o,i,s,l,r,a,c,d,u,p;return o=new mt({props:{properties:t[2]}}),r=new Ut({props:{fieldID:t[0]}}),r.$on("select",t[4]),u=new It({props:{fieldID:t[0]}}),u.$on("select",t[5]),{c(){e=m("h3"),e.textContent="Field",n=h(),Y(o.$$.fragment),i=h(),s=m("h3"),s.textContent="Portals",l=h(),Y(r.$$.fragment),a=h(),c=m("h3"),c.textContent="Links",d=h(),Y(u.$$.fragment)},m(t,f){g(t,e,f),g(t,n,f),Z(o,t,f),g(t,i,f),g(t,s,f),g(t,l,f),Z(r,t,f),g(t,a,f),g(t,c,f),g(t,d,f),Z(u,t,f),p=!0},p(t,e){const n={};4&e&&(n.properties=t[2]),o.$set(n);const i={};1&e&&(i.fieldID=t[0]),r.$set(i);const s={};1&e&&(s.fieldID=t[0]),u.$set(s)},i(t){p||(H(o.$$.fragment,t),H(r.$$.fragment,t),H(u.$$.fragment,t),p=!0)},o(t){B(o.$$.fragment,t),B(r.$$.fragment,t),B(u.$$.fragment,t),p=!1},d(t){t&&$(e),t&&$(n),K(o,t),t&&$(i),t&&$(s),t&&$(l),K(r,t),t&&$(a),t&&$(c),t&&$(d),K(u,t)}}}function Zt(t){let e,n,o=t[1]&&Yt(t);return{c(){e=m("div"),o&&o.c()},m(t,i){g(t,e,i),o&&o.m(e,null),n=!0},p(t,[n]){t[1]?o?(o.p(t,n),2&n&&H(o,1)):(o=Yt(t),o.c(),H(o,1),o.m(e,null)):o&&(N(),B(o,1,1,(()=>{o=null})),U())},i(t){n||(H(o),n=!0)},o(t){B(o),n=!1},d(t){t&&$(e),o&&o.d()}}}function Kt(t,e,n){let o,i;l(t,lt,(t=>n(3,i=t)));let{guid:s=null}=e,r=null;return t.$$set=t=>{"guid"in t&&n(0,s=t.guid)},t.$$.update=()=>{9&t.$$.dirty&&(s&&i[s]?n(1,r=i[s]):n(1,r=null)),2&t.$$.dirty&&n(2,o=r?{guid:r.options.guid,timestamp:xt(r.options.timestamp),team:r.options.team,"points[0].guid":r.options.data.points[0].guid,"points[0].latE6":r.options.data.points[0].latE6,"points[0].lngE6":r.options.data.points[0].lngE6,"points[1].guid":r.options.data.points[1].guid,"points[1].latE6":r.options.data.points[1].latE6,"points[1].lngE6":r.options.data.points[1].lngE6,"points[2].guid":r.options.data.points[2].guid,"points[2].latE6":r.options.data.points[2].latE6,"points[2].lngE6":r.options.data.points[2].lngE6}:{})},[s,r,o,i,function(e){C.call(this,t,e)},function(e){C.call(this,t,e)}]}class Qt extends W{constructor(t){super(),V(this,t,Kt,Zt,s,{guid:0})}}function Vt(t){let e,n,o;return{c(){e=m("li"),e.textContent="Current portal",x(e,"class","svelte-v62zqa"),y(e,"selected","portal"==t[0]&&t[1]==t[3])},m(i,s){g(i,e,s),n||(o=w(e,"click",t[5]),n=!0)},p(t,n){11&n&&y(e,"selected","portal"==t[0]&&t[1]==t[3])},d(t){t&&$(e),n=!1,o()}}}function Wt(t){let e,n;return e=new qt({props:{activeID:"field"==t[0]&&t[1]}}),e.$on("select",t[4]),{c(){Y(e.$$.fragment)},m(t,o){Z(e,t,o),n=!0},p(t,n){const o={};3&n&&(o.activeID="field"==t[0]&&t[1]),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Xt(t){let e,n;return e=new It({props:{activeID:"link"==t[0]&&t[1]}}),e.$on("select",t[4]),{c(){Y(e.$$.fragment)},m(t,o){Z(e,t,o),n=!0},p(t,n){const o={};3&n&&(o.activeID="link"==t[0]&&t[1]),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function te(t){let e,n;return e=new Ut({props:{activeID:"portal"==t[0]&&t[1]}}),e.$on("select",t[4]),{c(){Y(e.$$.fragment)},m(t,o){Z(e,t,o),n=!0},p(t,n){const o={};3&n&&(o.activeID="portal"==t[0]&&t[1]),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function ee(t){let e,n,o,i;const s=[ie,oe,ne],l=[];function r(t,e){return"portal"==t[0]?0:"link"==t[0]?1:"field"==t[0]?2:-1}return~(n=r(t))&&(o=l[n]=s[n](t)),{c(){e=m("div"),o&&o.c(),x(e,"class","card svelte-v62zqa")},m(t,o){g(t,e,o),~n&&l[n].m(e,null),i=!0},p(t,i){let a=n;n=r(t),n===a?~n&&l[n].p(t,i):(o&&(N(),B(l[a],1,1,(()=>{l[a]=null})),U()),~n?(o=l[n],o?o.p(t,i):(o=l[n]=s[n](t),o.c()),H(o,1),o.m(e,null)):o=null)},i(t){i||(H(o),i=!0)},o(t){B(o),i=!1},d(t){t&&$(e),~n&&l[n].d()}}}function ne(t){let e,n;return e=new Qt({props:{guid:t[1]}}),e.$on("select",t[4]),{c(){Y(e.$$.fragment)},m(t,o){Z(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.guid=t[1]),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function oe(t){let e,n;return e=new Rt({props:{guid:t[1]}}),e.$on("select",t[4]),{c(){Y(e.$$.fragment)},m(t,o){Z(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.guid=t[1]),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function ie(t){let e,n;return e=new Pt({props:{guid:t[1]}}),e.$on("select",t[4]),{c(){Y(e.$$.fragment)},m(t,o){Z(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.guid=t[1]),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function se(t){let e,n,i,s,l,r,a,c,d,u,p,v,k,b,D,I,E=t[3]&&Vt(t);const C=[te,Xt,Wt],S=[];function z(t,e){return"portals"==t[2]?0:"links"==t[2]?1:"fields"==t[2]?2:-1}~(p=z(t))&&(v=S[p]=C[p](t));let q=t[0]&&ee(t);return{c(){e=m("div"),n=m("div"),i=m("ul"),s=m("li"),s.textContent="Portals",l=h(),r=m("li"),r.textContent="Links",a=h(),c=m("li"),c.textContent="Fields",d=h(),E&&E.c(),u=h(),v&&v.c(),k=h(),q&&q.c(),x(s,"class","svelte-v62zqa"),y(s,"active","portals"==t[2]),x(r,"class","svelte-v62zqa"),y(r,"active","links"==t[2]),x(c,"class","svelte-v62zqa"),y(c,"active","fields"==t[2]),x(i,"class","tablist svelte-v62zqa"),x(n,"class","list svelte-v62zqa"),x(e,"class","content svelte-v62zqa")},m(o,$){g(o,e,$),f(e,n),f(n,i),f(i,s),f(i,l),f(i,r),f(i,a),f(i,c),f(i,d),E&&E.m(i,null),f(n,u),~p&&S[p].m(n,null),f(e,k),q&&q.m(e,null),b=!0,D||(I=[w(s,"click",t[6]),w(r,"click",t[7]),w(c,"click",t[8])],D=!0)},p(t,o){4&o&&y(s,"active","portals"==t[2]),4&o&&y(r,"active","links"==t[2]),4&o&&y(c,"active","fields"==t[2]),t[3]?E?E.p(t,o):(E=Vt(t),E.c(),E.m(i,null)):E&&(E.d(1),E=null);let l=p;p=z(t),p===l?~p&&S[p].p(t,o):(v&&(N(),B(S[l],1,1,(()=>{S[l]=null})),U()),~p?(v=S[p],v?v.p(t,o):(v=S[p]=C[p](t),v.c()),H(v,1),v.m(n,null)):v=null),t[0]?q?(q.p(t,o),1&o&&H(q,1)):(q=ee(t),q.c(),H(q,1),q.m(e,null)):q&&(N(),B(q,1,1,(()=>{q=null})),U())},i(t){b||(H(v),H(q),b=!0)},o(t){B(v),B(q),b=!1},d(t){t&&$(e),E&&E.d(),~p&&S[p].d(),q&&q.d(),D=!1,o(I)}}}function le(t){let e,n;return e=new et({props:{options:{title:"Data Explorer",resizable:!0,width:"auto"},$$slots:{default:[se]},$$scope:{ctx:t}}}),{c(){Y(e.$$.fragment)},m(t,o){Z(e,t,o),n=!0},p(t,[n]){const o={};1039&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function re(t,e,n){let o;l(t,rt,(t=>n(3,o=t)));let i=null,s=null;let r="portals";return[i,s,r,o,function(t){if(function(){switch(i){case"portal":break;case"link":const t=window.links[s];t&&t.setStyle({color:COLORS[t.options.team]});break;case"field":const e=window.fields[s];e&&e.setStyle({fillColor:COLORS[e.options.team]})}}(),t.detail)switch(n(0,i=t.detail.type),n(1,s=t.detail.guid),i){case"portal":window.selectPortal(s);break;case"link":const t=window.links[s];t&&t.setStyle({color:"red"});break;case"field":const e=window.fields[s];e&&(e.setStyle({fillColor:"red"}),e.bringToFront())}else n(1,s=null),n(0,i=null)},function(){window.selectedPortal&&(n(0,i="portal"),n(1,s=window.selectedPortal))},()=>n(2,r="portals"),()=>n(2,r="links"),()=>n(2,r="fields")]}registerCSS(".content.svelte-v62zqa.svelte-v62zqa{display:grid;grid-gap:24px;grid-auto-flow:column}.tablist.svelte-v62zqa.svelte-v62zqa{padding-left:1em}.tablist.svelte-v62zqa li.svelte-v62zqa{display:inline-block}.tablist.svelte-v62zqa li.active.svelte-v62zqa{font-weight:bold}.tablist.svelte-v62zqa li.selected.svelte-v62zqa{color:red;font-weight:bold}.tablist.svelte-v62zqa li.svelte-v62zqa:nth-child(n + 2)::before{content:'| '}.content.svelte-v62zqa>div.svelte-v62zqa{background-color:#0003;border-radius:10px;padding:0.5em}.content.svelte-v62zqa .grid{padding:0.5em;border:1px solid #69a;background-color:#0001;box-sizing:border-box}@media(max-width: 700px){.content.svelte-v62zqa>div.svelte-v62zqa{box-sizing:border-box;width:calc(100vw - 24px)}}");class ae extends W{constructor(t){super(),V(this,t,re,le,s,{})}}function ce(e){let n,o,i;return{c(){n=m("a"),n.textContent="DataExplorer"},m(t,s){g(t,n,s),o||(i=w(n,"click",e[0]),o=!0)},p:t,i:t,o:t,d(t){t&&$(n),o=!1,i()}}}function de(t,e,n){let o,i,s,r;return l(t,rt,(t=>n(1,o=t))),l(t,lt,(t=>n(2,i=t))),l(t,st,(t=>n(3,s=t))),l(t,it,(t=>n(4,r=t))),p(it,r=window.portals,r),p(st,s=window.links,s),p(lt,i=window.fields,i),p(rt,o=window.selectedPortal,o),window.addHook("mapDataRefreshEnd",(()=>{p(it,r=window.portals,r),p(st,s=window.links,s),p(lt,i=window.fields,i)})),window.addHook("portalAdded",(t=>{p(it,r[t.portal.options.guid]=t.portal,r)})),window.addHook("linkAdded",(t=>{p(st,s[t.link.options.guid]=t.link,s)})),window.addHook("fieldAdded",(t=>{p(lt,i[t.field.options.guid]=t.field,i)})),window.addHook("portalSelected",(t=>{p(rt,o=t.selectedPortalGuid,o)})),[function(){new ae({target:document.body})}]}class ue extends W{constructor(t){super(),V(this,t,de,ce,s,{})}}const pe="dataExplorer";class fe{init(){const t=document.querySelector("#toolbox");new ue({target:t})}}return()=>{window.plugin[pe]=new fe,window.plugin[pe].init(),addCSSs()}}();
setup.info = plugin_info; //add the script info data to the function as a property
if(!window.bootPlugins) window.bootPlugins = [];
window.bootPlugins.push(setup);
// if IITC has already booted, immediately run the 'setup' function
if(window.iitcLoaded && typeof setup === 'function') setup();
} // wrapper end
// inject code into site context
var script = document.createElement('script');
var info = {};
if (typeof GM_info !== 'undefined' && GM_info && GM_info.script) info.script = { version: GM_info.script.version, name: GM_info.script.name, description: GM_info.script.description };
script.appendChild(document.createTextNode('('+ wrapper +')('+JSON.stringify(info)+');'));
(document.body || document.head || document.documentElement).appendChild(script);
