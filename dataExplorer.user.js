// ==UserScript==
// @author        jaiperdu
// @name          IITC plugin: Data Explorer
// @category      Misc
// @version       0.1.17
// @description   UI to explore intel available data
// @id            dataExplorer
// @namespace     https://github.com/le-jeu
// @updateURL     https://github.com/le-jeu/iitc-data-explorer/raw/dist/dataExplorer.user.js
// @downloadURL   https://github.com/le-jeu/iitc-data-explorer/raw/dist/dataExplorer.user.js
// @match         https://intel.ingress.com/*
// @grant         none
// ==/UserScript==
function wrapper() {
var setup=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function l(t,e,n,o){if(t){const i=a(t,e,n,o);return t[0](i)}}function a(t,e,n,o){return t[1]&&o?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](o(e))):n.ctx}function c(t,e,n,o){if(t[2]&&o){const i=t[2](o(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|i[o];return t}return e.dirty|i}return e.dirty}function u(t,e,n,o,i,s){if(i){const r=a(e,n,o,s);t.p(r,i)}}function d(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function f(t,e,n){return t.set(n),e}function p(t,e){t.appendChild(e)}function g(t,e,n){const o=function(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;if(e&&e.host)return e;return t.ownerDocument}(t);if(!o.getElementById(e)){const t=w("style");t.id=e,t.textContent=n,function(t,e){p(t.head||t,e),e.sheet}(o,t)}}function $(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode&&t.parentNode.removeChild(t)}function h(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function w(t){return document.createElement(t)}function v(t){return document.createTextNode(t)}function I(){return v(" ")}function x(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function D(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t){return""===t?null:+t}function y(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function k(t,e){t.value=null==e?"":e}function L(t,e,n){t.classList[n?"add":"remove"](e)}let E;function C(t){E=t}function S(){if(!E)throw new Error("Function called outside component initialization");return E}function T(t){S().$$.on_destroy.push(t)}function F(){const t=S();return(e,n,{cancelable:o=!1}={})=>{const i=t.$$.callbacks[e];if(i){const s=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,o,e),i}(e,n,{cancelable:o});return i.slice().forEach((e=>{e.call(t,s)})),!s.defaultPrevented}return!0}}function P(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const _=[],j=[],M=[],z=[],N=Promise.resolve();let G=!1;function q(t){M.push(t)}const R=new Set;let A=0;function J(){const t=E;do{for(;A<_.length;){const t=_[A];A++,C(t),O(t.$$)}for(C(null),_.length=0,A=0;j.length;)j.pop()();for(let t=0;t<M.length;t+=1){const e=M[t];R.has(e)||(R.add(e),e())}M.length=0}while(_.length);for(;z.length;)z.pop()();G=!1,R.clear(),C(t)}function O(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(q)}}const H=new Set;let U;function B(){U={r:0,c:[],p:U}}function W(){U.r||o(U.c),U=U.p}function Y(t,e){t&&t.i&&(H.delete(t),t.i(e))}function Z(t,e,n,o){if(t&&t.o){if(H.has(t))return;H.add(t),U.c.push((()=>{H.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function X(t){t&&t.c()}function Q(t,n,s,r){const{fragment:l,after_update:a}=t.$$;l&&l.m(n,s),r||q((()=>{const n=t.$$.on_mount.map(e).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),a.forEach(q)}function K(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function V(t,e){-1===t.$$.dirty[0]&&(_.push(t),G||(G=!0,N.then(J)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function tt(e,i,s,r,l,a,c,u=[-1]){const d=E;C(e);const f=e.$$={fragment:null,ctx:[],props:a,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(d?d.$$.context:[])),callbacks:n(),dirty:u,skip_bound:!1,root:i.target||d.$$.root};c&&c(f.root);let p=!1;if(f.ctx=s?s(e,i.props||{},((t,n,...o)=>{const i=o.length?o[0]:n;return f.ctx&&l(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),p&&V(e,t)),n})):[],f.update(),p=!0,o(f.before_update),f.fragment=!!r&&r(f.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);f.fragment&&f.fragment.l(t),t.forEach(m)}else f.fragment&&f.fragment.c();i.intro&&Y(e.$$.fragment),Q(e,i.target,i.anchor,i.customElement),J()}C(d)}class et{$destroy(){K(this,1),this.$destroy=t}$on(e,n){if(!i(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function nt(t){g(t,"svelte-63xka0",".ui-dialog.full-width-dialog{max-width:calc(100vw - 2px)}")}function ot(t){let e,n;const o=t[3].default,i=l(o,t,t[2],null);return{c(){e=w("div"),i&&i.c()},m(o,s){$(o,e,s),i&&i.m(e,null),t[4](e),n=!0},p(t,[e]){i&&i.p&&(!n||4&e)&&u(i,o,t,t[2],n?c(o,t[2],e,null):d(t[2]),null)},i(t){n||(Y(i,t),n=!0)},o(t){Z(i,t),n=!1},d(n){n&&m(e),i&&i.d(n),t[4](null)}}}function it(t,e,n){let o,{$$slots:i={},$$scope:s}=e,{options:r={}}=e,l=F();var a;return a=()=>{const t=r.closeCallback;dialog(Object.assign(r,{html:o,closeCallback:()=>{t&&t(),l("close")}}))},S().$$.on_mount.push(a),t.$$set=t=>{"options"in t&&n(1,r=t.options),"$$scope"in t&&n(2,s=t.$$scope)},[o,r,s,i,function(t){j[t?"unshift":"push"]((()=>{o=t,n(0,o)}))}]}class st extends et{constructor(t){super(),tt(this,t,it,ot,s,{options:1},nt)}}const rt=[];function lt(e,n=t){let o;const i=new Set;function r(t){if(s(e,t)&&(e=t,o)){const t=!rt.length;for(const t of i)t[1](),rt.push(t,e);if(t){for(let t=0;t<rt.length;t+=2)rt[t][0](rt[t+1]);rt.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(s,l=t){const a=[s,l];return i.add(a),1===i.size&&(o=n(r)||t),s(e),()=>{i.delete(a),0===i.size&&(o(),o=null)}}}}const at=lt({}),ct=lt({}),ut=lt({}),dt=lt({}),ft=lt(null);function pt(t){g(t,"svelte-1jc6t41","div.grid.svelte-1jc6t41.svelte-1jc6t41{display:grid;grid-template-columns:max-content auto;grid-gap:4px;box-sizing:border-box;padding:0.5em;border:1px solid #69a;background-color:#0001;max-width:100%;width:max-content;font-family:monospace}div.grid.svelte-1jc6t41>div.svelte-1jc6t41{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:30em}")}function gt(t,e,n){const o=t.slice();return o[4]=e[n][0],o[5]=e[n][1],o}const $t=t=>({key:1&t}),mt=t=>({key:t[4]}),ht=t=>({key:1&t}),wt=t=>({key:t[4]});function vt(t){let e,n,o,i,s,r;const a=t[3].key,f=l(a,t,t[2],wt),g=f||function(t){let e,n=t[4]+"";return{c(){e=v(n)},m(t,n){$(t,e,n)},p(t,o){1&o&&n!==(n=t[4]+"")&&y(e,n)},d(t){t&&m(e)}}}(t),h=t[3].value,x=l(h,t,t[2],mt),b=x||function(t){let e,n=t[5]+"";return{c(){e=v(n)},m(t,n){$(t,e,n)},p(t,o){1&o&&n!==(n=t[5]+"")&&y(e,n)},d(t){t&&m(e)}}}(t);return{c(){e=w("div"),g&&g.c(),n=I(),o=w("div"),b&&b.c(),i=I(),D(e,"class","svelte-1jc6t41"),D(o,"title",s=t[1][t[4]]||t[5]),D(o,"class","svelte-1jc6t41")},m(t,s){$(t,e,s),g&&g.m(e,null),$(t,n,s),$(t,o,s),b&&b.m(o,null),p(o,i),r=!0},p(t,e){f?f.p&&(!r||5&e)&&u(f,a,t,t[2],r?c(a,t[2],e,ht):d(t[2]),wt):g&&g.p&&(!r||1&e)&&g.p(t,r?e:-1),x?x.p&&(!r||5&e)&&u(x,h,t,t[2],r?c(h,t[2],e,$t):d(t[2]),mt):b&&b.p&&(!r||1&e)&&b.p(t,r?e:-1),(!r||3&e&&s!==(s=t[1][t[4]]||t[5]))&&D(o,"title",s)},i(t){r||(Y(g,t),Y(b,t),r=!0)},o(t){Z(g,t),Z(b,t),r=!1},d(t){t&&m(e),g&&g.d(t),t&&m(n),t&&m(o),b&&b.d(t)}}}function It(t){let e,n,o=Object.entries(t[0]),i=[];for(let e=0;e<o.length;e+=1)i[e]=vt(gt(t,o,e));const s=t=>Z(i[t],1,1,(()=>{i[t]=null}));return{c(){e=w("div");for(let t=0;t<i.length;t+=1)i[t].c();D(e,"class","grid svelte-1jc6t41")},m(t,o){$(t,e,o);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,[n]){if(7&n){let r;for(o=Object.entries(t[0]),r=0;r<o.length;r+=1){const s=gt(t,o,r);i[r]?(i[r].p(s,n),Y(i[r],1)):(i[r]=vt(s),i[r].c(),Y(i[r],1),i[r].m(e,null))}for(B(),r=o.length;r<i.length;r+=1)s(r);W()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)Y(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)Z(i[t]);n=!1},d(t){t&&m(e),h(i,t)}}}function xt(t,e,n){let{$$slots:o={},$$scope:i}=e,{properties:s}=e,{titles:r={}}=e;return t.$$set=t=>{"properties"in t&&n(0,s=t.properties),"titles"in t&&n(1,r=t.titles),"$$scope"in t&&n(2,i=t.$$scope)},[s,r,i,o]}class Dt extends et{constructor(t){super(),tt(this,t,xt,It,s,{properties:0,titles:1},pt)}}function bt(t){const e=Math.PI/180,n=t.lat*e,o=t.lng*e,i=Math.cos(n);return[Math.cos(o)*i,Math.sin(o)*i,Math.sin(n)]}function yt(t){const e=180/Math.PI;return{lat:Math.atan2(t[2],Math.sqrt(t[0]*t[0]+t[1]*t[1]))*e,lng:Math.atan2(t[1],t[0])*e}}function kt(t){let e=function(t){const e=[Math.abs(t[0]),Math.abs(t[1]),Math.abs(t[2])];return e[0]>e[1]?e[0]>e[2]?0:2:e[1]>e[2]?1:2}(t);t[e]<0&&(e+=3);const n=function(t,e){let n,o;switch(t){case 0:n=e[1]/e[0],o=e[2]/e[0];break;case 1:n=-e[0]/e[1],o=e[2]/e[1];break;case 2:n=-e[0]/e[2],o=-e[1]/e[2];break;case 3:n=e[2]/e[0],o=e[1]/e[0];break;case 4:n=e[2]/e[1],o=-e[0]/e[1];break;case 5:n=-e[1]/e[2],o=-e[0]/e[2];break;default:throw{error:"Invalid face"}}return[n,o]}(e,t);return[e,n]}function Lt(t,e){const n=e[0],o=e[1];switch(t){case 0:return[1,n,o];case 1:return[-n,1,o];case 2:return[-n,-o,1];case 3:return[-1,-o,-n];case 4:return[o,-1,-n];case 5:return[o,n,-1];default:throw{error:"Invalid face"}}}function Et(t){function e(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}return[e(t[0]),e(t[1])]}function Ct(t){function e(t){return t>=0?.5*Math.sqrt(1+3*t):1-.5*Math.sqrt(1-3*t)}return[e(t[0]),e(t[1])]}function St(t,e){const n=1<<e;function o(t){const e=Math.floor(t*n);return Math.max(0,Math.min(n-1,e))}return[o(t[0]),o(t[1])]}function Tt(t,e,n){const o=1<<e;return[(t[0]+n[0])/o,(t[1]+n[1])/o]}function Ft(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Pt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function _t(t,e,n){return Pt(Ft(t,e),n)}function jt(t,e,n,o){const i=Ft(t,e),s=-Pt(i,n);if(s*Pt(i,o)<=0)return!1;const r=Ft(n,o),l=-Pt(r,e),a=Pt(r,t);return s*l>0&&s*a>0}class Mt{constructor(t){this.points=t||[]}empty(){return 0==this.points.length}mayIntersect(t){if(this.empty())return!1;for(const e of this.points)if(t.contains(e))return!0;const e=t.getCornerXYZ();for(let t=this.points.length-1;t>0;t--)if(e.some(((n,o)=>jt(this.points[t],this.points[t-1],n,e[(o+1)%4]))))return!0;return!1}}class zt extends Mt{constructor(t,e,n){super([t,e,n,t]),this.center=[t[0]+e[0]+n[0],t[1]+e[1]+n[1],t[2]+e[2]+n[2]],this.centerSides=[_t(this.center,t,e),_t(this.center,e,n),_t(this.center,n,t)]}empty(){return!1}containsPoint(t){return!(_t(t,this.points[0],this.points[1])*this.centerSides[0]<0)&&(!(_t(t,this.points[1],this.points[2])*this.centerSides[1]<0)&&!(_t(t,this.points[2],this.points[0])*this.centerSides[2]<0))}mayIntersect(t){if(Mt.prototype.mayIntersect.call(this,t))return!0;const e=t.getCornerXYZ();for(const t of e)if(this.containsPoint(t))return!0;return!1}}class Nt{getCoveringPoint(t){const[e,n]=kt(t),o=St(Ct(n),this.level);return Gt.FromFaceIJ(e,o,this.level)}getCoveringFromCell(t){const e=[],n={},o=[t];for(n[t.toString()]=!0;o.length;){const t=o.pop();if(this.region.mayIntersect(t)){e.push(t);for(const e of t.getNeighbors())e.toString()in n||(n[e.toString()]=!0,o.push(e))}}return e}getCovering(t,e){return this.region=t,this.level=e,this.region.empty()?[]:this.region instanceof Mt?this.getCoveringFromCell(this.getCoveringPoint(this.region.points[0])):[]}}class Gt{static FromLatLng(t,e){const n=kt(bt(t)),o=St(Ct(n[1]),e);return Gt.FromFaceIJ(n[0],o,e)}static FromFaceIJ(t,e,n){const o=new Gt;o.face=t,o.ij=e,o.level=n;const i=Et(Tt(o.ij,o.level,[0,0])),s=Et(Tt(o.ij,o.level,[1,1]));return o.uvBound=[i,s],o}toString(){return"F"+this.face+"ij["+this.ij[0]+","+this.ij[1]+"]@"+this.level}contains(t){const[e,n]=kt(t);if(e!=this.face)return!1;const[o,i]=this.uvBound;return o[0]<=n[0]&&n[0]<=i[0]&&o[1]<=n[1]&&n[1]<=i[1]}getLatLng(){const t=Et(Tt(this.ij,this.level,[.5,.5]));return yt(Lt(this.face,t))}getCornerXYZ(){const t=[],e=[[0,0],[0,1],[1,1],[1,0]];for(let n=0;n<4;n++){const o=Et(Tt(this.ij,this.level,e[n]));t.push(Lt(this.face,o))}return t}getCornerLatLngs(){return this.getCornerXYZ().map(yt)}getFaceAndQuads(){const t=function(t,e,n){const o={a:[[0,"d"],[1,"a"],[3,"b"],[2,"a"]],b:[[2,"b"],[1,"b"],[3,"a"],[0,"c"]],c:[[2,"c"],[3,"d"],[1,"c"],[0,"b"]],d:[[0,"a"],[3,"c"],[1,"d"],[2,"d"]]};let i="a";const s=[];for(let r=n-1;r>=0;r--){const n=1<<r,l=o[i][2*(t&n?1:0)+(e&n?1:0)];s.push(l[0]),i=l[1]}return s}(this.ij[0],this.ij[1],this.level);return[this.face,t]}getNeighbors(){function t(t,e,n){const o=1<<n;if(e[0]>=0&&e[1]>=0&&e[0]<o&&e[1]<o)return Gt.FromFaceIJ(t,e,n);{let o=Tt(e,n,[.5,.5]),i=Et(o);const s=kt(Lt(t,i));return t=s[0],i=s[1],o=Ct(i),e=St(o,n),Gt.FromFaceIJ(t,e,n)}}const e=this.face,n=this.ij[0],o=this.ij[1],i=this.level;return[t(e,[n-1,o],i),t(e,[n,o-1],i),t(e,[n+1,o],i),t(e,[n,o+1],i)]}getChildren(){const t=this.face,e=2*this.ij[0],n=2*this.ij[1],o=this.level+1;return[Gt.FromFaceIJ(t,[e,n],o),Gt.FromFaceIJ(t,[e,n+1],o),Gt.FromFaceIJ(t,[e+1,n],o),Gt.FromFaceIJ(t,[e+1,n+1],o)]}getParent(){if(this.level<=1)return null;const t=this.face,e=this.ij[0]>>1,n=this.ij[1]>>1,o=this.level-1;return Gt.FromFaceIJ(t,[e,n],o)}}function qt(t,e){return!!window.fields[e]&&window.fields[e].options.data.points.some((e=>e.guid==t))}function Rt(t,e){const n=window.links[t];return!!n&&(qt(n.options.data.oGuid,e)&&qt(n.options.data.dGuid,e))}function At(t){const e=new Date(t),n=e.getUTCFullYear()+"",o=e.getUTCMonth()+1+"",i=e.getUTCDate()+"",s=e.getUTCHours()+"",r=e.getUTCMinutes()+"",l=e.getUTCSeconds()+"",a=e.getUTCMilliseconds()+"";return`${n}-${o.padStart(2,"0")}-${i.padStart(2,"0")}T${s.padStart(2,"0")}:${r.padStart(2,"0")}:${l.padStart(2,"0")}.${a.padStart(3,"0")}Z`}function Jt(t){const[e,n,o,i,s,r]=t.split("_"),l=window.TILE_PARAMS.TILES_PER_EDGE[window.TILE_PARAMS.TILES_PER_EDGE.length-1],a={tilesPerEdge:window.TILE_PARAMS.TILES_PER_EDGE[+e]||l},c=window.tileToLat(+o,a),u=window.tileToLat(+o+1,a);return{zoom:+e,x:+n,y:+o,minlvl:+i,maxlvl:+s,maxhealth:+r,latNorth:c,lngWest:window.tileToLng(+n,a),latSouth:u,lngEast:window.tileToLng(+n+1,a)}}function Ot(t){g(t,"svelte-6btztf",".grid.svelte-6btztf.svelte-6btztf{display:grid;grid-template-columns:auto max-content;grid-gap:4px;box-sizing:border-box;padding:0.5em;border:1px solid #69a;background-color:#0001;max-width:100%;width:max-content}.grid.svelte-6btztf div.svelte-6btztf{white-space:nowrap;max-width:30em}.grid.svelte-6btztf div.svelte-6btztf:nth-child(2n + 1){text-overflow:ellipsis;overflow:hidden}.raw.svelte-6btztf.svelte-6btztf{font-family:monospace}.grid.svelte-6btztf .guid.svelte-6btztf{cursor:pointer}.date.svelte-6btztf.svelte-6btztf{margin-left:auto}.selected.svelte-6btztf.svelte-6btztf{color:red}.active.svelte-6btztf.svelte-6btztf{color:green}")}function Ht(t,e,n){const o=t.slice();return o[8]=e[n],o}function Ut(t){let e,n,i,s,r,l,a,c,u=(t[8][2].name||t[8][0])+"",d=At(t[8][1])+"";function f(){return t[5](t[8])}function g(){return t[6](t[8])}return{c(){e=w("div"),n=v(u),i=I(),s=w("div"),r=v(d),l=I(),D(e,"class","guid svelte-6btztf"),L(e,"raw",!t[8][2].name),L(e,"enl","E"===t[8][2].team),L(e,"res","R"===t[8][2].team),L(e,"mac","M"===t[8][2].team),L(e,"selected",t[2]==t[8][0]),L(e,"active",t[1]==t[8][0]),D(s,"class","date raw svelte-6btztf"),L(s,"selected",t[2]==t[8][0]),L(s,"active",t[1]==t[8][0])},m(t,o){$(t,e,o),p(e,n),$(t,i,o),$(t,s,o),p(s,r),p(s,l),a||(c=[x(e,"click",f),x(s,"dblclick",g)],a=!0)},p(o,i){t=o,1&i&&u!==(u=(t[8][2].name||t[8][0])+"")&&y(n,u),1&i&&L(e,"raw",!t[8][2].name),1&i&&L(e,"enl","E"===t[8][2].team),1&i&&L(e,"res","R"===t[8][2].team),1&i&&L(e,"mac","M"===t[8][2].team),5&i&&L(e,"selected",t[2]==t[8][0]),3&i&&L(e,"active",t[1]==t[8][0]),1&i&&d!==(d=At(t[8][1])+"")&&y(r,d),5&i&&L(s,"selected",t[2]==t[8][0]),3&i&&L(s,"active",t[1]==t[8][0])},d(t){t&&m(e),t&&m(i),t&&m(s),a=!1,o(c)}}}function Bt(e){let n,o=e[0],i=[];for(let t=0;t<o.length;t+=1)i[t]=Ut(Ht(e,o,t));return{c(){n=w("div");for(let t=0;t<i.length;t+=1)i[t].c();D(n,"class","grid svelte-6btztf")},m(t,e){$(t,n,e);for(let t=0;t<i.length;t+=1)i[t].m(n,null)},p(t,[e]){if(15&e){let s;for(o=t[0],s=0;s<o.length;s+=1){const r=Ht(t,o,s);i[s]?i[s].p(r,e):(i[s]=Ut(r),i[s].c(),i[s].m(n,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=o.length}},i:t,o:t,d(t){t&&m(n),h(i,t)}}}function Wt(t,e,n){const o=F();let{items:i}=e,{activeID:s}=e,{selectedID:r=null}=e,{type:l}=e;function a(t){o("select",{type:l,guid:t})}return t.$$set=t=>{"items"in t&&n(0,i=t.items),"activeID"in t&&n(1,s=t.activeID),"selectedID"in t&&n(2,r=t.selectedID),"type"in t&&n(4,l=t.type)},[i,s,r,a,l,t=>a(t[0]),t=>function(t){if(Date.now()-t>26784e5)return;const e=window.chat._public;e.data={},e.guids=[],e.oldestTimestamp=t+1e3,e.newestTimestamp=t-1e3,delete e.oldestGUID,delete e.newestGUID,window.chat.requestPublic(!0,!1)}(t[1])]}class Yt extends et{constructor(t){super(),tt(this,t,Wt,Bt,s,{items:0,activeID:1,selectedID:2,type:4},Ot)}}function Zt(t){let e,n;return e=new Yt({props:{type:"link",items:t[1].map(t[7]),activeID:t[0]}}),e.$on("select",t[8]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,[n]){const o={};6&n&&(o.items=t[1].map(t[7])),1&n&&(o.activeID=t[0]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Xt(t,e,n){let o,i;r(t,ct,(t=>n(2,o=t))),r(t,dt,(t=>n(6,i=t)));let{portalID:s=null}=e,{activeID:l=!1}=e,{fieldID:a=null}=e,{tileID:c=null}=e,u=[];return t.$$set=t=>{"portalID"in t&&n(3,s=t.portalID),"activeID"in t&&n(0,l=t.activeID),"fieldID"in t&&n(4,a=t.fieldID),"tileID"in t&&n(5,c=t.tileID)},t.$$.update=()=>{if(126&t.$$.dirty){if(c){const t=i[c];n(1,u=t?t.entities.filter((t=>"e"==t[0])).map((t=>t[1])):[]),n(1,u=u.filter((t=>o[t])))}else n(1,u=Object.keys(o).filter((t=>{return(!s||(e=s,n=t,!!window.links[n]&&(window.links[n].options.data.oGuid==e||window.links[n].options.data.dGuid==e)))&&(!a||Rt(t,a));var e,n})));u.sort(((t,e)=>o[e].options.timestamp-o[t].options.timestamp))}},[l,u,o,s,a,c,i,t=>[t,o[t].options.timestamp,{team:o[t].options.data.team}],function(e){P.call(this,t,e)}]}class Qt extends et{constructor(t){super(),tt(this,t,Xt,Zt,s,{portalID:3,activeID:0,fieldID:4,tileID:5})}}function Kt(t){let e,n;return e=new Yt({props:{type:"field",items:t[1].map(t[7]),activeID:t[0]}}),e.$on("select",t[8]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,[n]){const o={};6&n&&(o.items=t[1].map(t[7])),1&n&&(o.activeID=t[0]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Vt(t,e,n){let o,i;r(t,ut,(t=>n(2,o=t))),r(t,dt,(t=>n(6,i=t)));let{portalID:s=null}=e,{linkID:l=null}=e,{activeID:a=!1}=e,{tileID:c=null}=e,u=[];return t.$$set=t=>{"portalID"in t&&n(3,s=t.portalID),"linkID"in t&&n(4,l=t.linkID),"activeID"in t&&n(0,a=t.activeID),"tileID"in t&&n(5,c=t.tileID)},t.$$.update=()=>{if(126&t.$$.dirty){if(c){const t=i[c];n(1,u=t?t.entities.filter((t=>"r"==t[0])).map((t=>t[1])):[]),n(1,u=u.filter((t=>o[t])))}else n(1,u=Object.keys(o).filter((t=>(!s||qt(s,t))&&(!l||Rt(l,t)))));u.sort(((t,e)=>o[e].options.timestamp-o[t].options.timestamp))}},[a,u,o,s,l,c,i,t=>[t,o[t].options.timestamp,{team:o[t].options.data.team}],function(e){P.call(this,t,e)}]}class te extends et{constructor(t){super(),tt(this,t,Vt,Kt,s,{portalID:3,linkID:4,activeID:0,tileID:5})}}function ee(t){let e,n;return e=new Yt({props:{type:"tile",items:t[1].map(t[6]),activeID:t[0]}}),e.$on("select",t[7]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,[n]){const o={};6&n&&(o.items=t[1].map(t[6])),1&n&&(o.activeID=t[0]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function ne(t,e,n){let o;r(t,dt,(t=>n(2,o=t)));let{portalID:i=null}=e,{linkID:s=null}=e,{fieldID:l=null}=e,{activeID:a=!1}=e,c=[],u=window.L.layerGroup().addTo(window.map);T((()=>{u.remove()}));return t.$$set=t=>{"portalID"in t&&n(3,i=t.portalID),"linkID"in t&&n(4,s=t.linkID),"fieldID"in t&&n(5,l=t.fieldID),"activeID"in t&&n(0,a=t.activeID)},t.$$.update=()=>{if(62&t.$$.dirty&&(n(1,c=Object.keys(o).filter((t=>(!i||o[t].entities.some((t=>t[1]==i)))&&(!s||o[t].entities.some((t=>t[1]==s)))&&(!l||o[t].entities.some((t=>t[1]==l)))))),c.sort(((t,e)=>o[e].time-o[t].time))),58&t.$$.dirty&&(u.clearLayers(),i||s||l))for(const t of c){const e=Jt(t);window.L.rectangle([[e.latSouth,e.lngWest],[e.latNorth,e.lngEast]],{color:"purple",interactive:!1}).addTo(u)}},[a,c,o,i,s,l,t=>[t,o[t].time,{}],function(e){P.call(this,t,e)}]}class oe extends et{constructor(t){super(),tt(this,t,ne,ee,s,{portalID:3,linkID:4,fieldID:5,activeID:0})}}function ie(t){g(t,"svelte-176lmyd","h3.svelte-176lmyd:hover{text-decoration:underline;cursor:pointer}")}function se(t){let e,n,o,i,s,r,l,a,c,u,d,f,p,g,h,v,b,y;return o=new Dt({props:{properties:t[3],titles:t[2],$$slots:{value:[ae,({key:t})=>({9:t}),({key:t})=>t?512:0]},$$scope:{ctx:t}}}),l=new Qt({props:{portalID:t[0]}}),l.$on("select",t[6]),d=new te({props:{portalID:t[0]}}),d.$on("select",t[7]),h=new oe({props:{portalID:t[0]}}),h.$on("select",t[8]),{c(){e=w("h3"),e.textContent="Portal ↻",n=I(),X(o.$$.fragment),i=I(),s=w("h3"),s.textContent="Links",r=I(),X(l.$$.fragment),a=I(),c=w("h3"),c.textContent="Fields",u=I(),X(d.$$.fragment),f=I(),p=w("h3"),p.textContent="Tiles",g=I(),X(h.$$.fragment),D(e,"class","svelte-176lmyd"),D(s,"class","svelte-176lmyd"),D(c,"class","svelte-176lmyd"),D(p,"class","svelte-176lmyd")},m(m,w){$(m,e,w),$(m,n,w),Q(o,m,w),$(m,i,w),$(m,s,w),$(m,r,w),Q(l,m,w),$(m,a,w),$(m,c,w),$(m,u,w),Q(d,m,w),$(m,f,w),$(m,p,w),$(m,g,w),Q(h,m,w),v=!0,b||(y=x(e,"click",t[5]),b=!0)},p(t,e){const n={};8&e&&(n.properties=t[3]),4&e&&(n.titles=t[2]),1544&e&&(n.$$scope={dirty:e,ctx:t}),o.$set(n);const i={};1&e&&(i.portalID=t[0]),l.$set(i);const s={};1&e&&(s.portalID=t[0]),d.$set(s);const r={};1&e&&(r.portalID=t[0]),h.$set(r)},i(t){v||(Y(o.$$.fragment,t),Y(l.$$.fragment,t),Y(d.$$.fragment,t),Y(h.$$.fragment,t),v=!0)},o(t){Z(o.$$.fragment,t),Z(l.$$.fragment,t),Z(d.$$.fragment,t),Z(h.$$.fragment,t),v=!1},d(t){t&&m(e),t&&m(n),K(o,t),t&&m(i),t&&m(s),t&&m(r),K(l,t),t&&m(a),t&&m(c),t&&m(u),K(d,t),t&&m(f),t&&m(p),t&&m(g),K(h,t),b=!1,y()}}}function re(t){let e,n=t[3][t[9]]+"";return{c(){e=v(n)},m(t,n){$(t,e,n)},p(t,o){520&o&&n!==(n=t[3][t[9]]+"")&&y(e,n)},d(t){t&&m(e)}}}function le(t){let e,n,o,i=t[3][t[9]]+"";return{c(){e=w("a"),n=v(i),D(e,"href",o=t[3][t[9]])},m(t,o){$(t,e,o),p(e,n)},p(t,s){520&s&&i!==(i=t[3][t[9]]+"")&&y(n,i),520&s&&o!==(o=t[3][t[9]])&&D(e,"href",o)},d(t){t&&m(e)}}}function ae(t){let e;function n(t,e){return"image"==t[9]?le:re}let o=n(t),i=o(t);return{c(){i.c(),e=v("")},m(t,n){i.m(t,n),$(t,e,n)},p(t,s){o===(o=n(t))&&i?i.p(t,s):(i.d(1),i=o(t),i&&(i.c(),i.m(e.parentNode,e)))},d(t){i.d(t),t&&m(e)}}}function ce(t){let e,n,o=t[1]&&se(t);return{c(){e=w("div"),o&&o.c()},m(t,i){$(t,e,i),o&&o.m(e,null),n=!0},p(t,[n]){t[1]?o?(o.p(t,n),2&n&&Y(o,1)):(o=se(t),o.c(),Y(o,1),o.m(e,null)):o&&(B(),Z(o,1,1,(()=>{o=null})),W())},i(t){n||(Y(o),n=!0)},o(t){Z(o),n=!1},d(t){t&&m(e),o&&o.d()}}}function ue(t,e,n){let o,i,s;r(t,at,(t=>n(4,s=t)));let{guid:l=null}=e,a=null;return t.$$set=t=>{"guid"in t&&n(0,l=t.guid)},t.$$.update=()=>{17&t.$$.dirty&&(l&&s[l]?n(1,a=s[l]):n(1,a=null)),2&t.$$.dirty&&n(3,o=a?{guid:a.options.guid,timestamp:At(a.options.timestamp),team:a.options.data.team,latE6:a.options.data.latE6,lngE6:a.options.data.lngE6,level:a.options.data.level,health:a.options.data.health,resCount:a.options.data.resCount,image:a.options.data.image,title:a.options.data.title,ornaments:a.options.data.ornaments,mission:a.options.data.mission,mission50plus:a.options.data.mission50plus,artifactBrief:JSON.stringify(a.options.data.artifactBrief),mods:JSON.stringify(a.options.data.mods),resonators:JSON.stringify(a.options.data.resonators),owner:a.options.data.owner,artifactDetail:JSON.stringify(a.options.data.artifactDetail),history:a.options.data.history&&a.options.data.history._raw||0}:{}),2&t.$$.dirty&&n(2,i=a?{image:'<img src="'+a.options.data.image+'" style="width: 100px; height=100px"/>'}:{})},[l,a,i,o,s,()=>window.renderPortalDetails(l),function(e){P.call(this,t,e)},function(e){P.call(this,t,e)},function(e){P.call(this,t,e)}]}class de extends et{constructor(t){super(),tt(this,t,ue,ce,s,{guid:0},ie)}}function fe(t){let e,n;return e=new Yt({props:{type:"portal",items:t[1].map(t[8]),selectedID:t[3],activeID:t[0]}}),e.$on("select",t[9]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,[n]){const o={};6&n&&(o.items=t[1].map(t[8])),8&n&&(o.selectedID=t[3]),1&n&&(o.activeID=t[0]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function pe(t,e,n){let o,i,s;r(t,at,(t=>n(2,o=t))),r(t,dt,(t=>n(7,i=t))),r(t,ft,(t=>n(3,s=t)));let{activeID:l=!1}=e,{linkID:a=null}=e,{fieldID:c=null}=e,{tileID:u=null}=e,d=[];return t.$$set=t=>{"activeID"in t&&n(0,l=t.activeID),"linkID"in t&&n(4,a=t.linkID),"fieldID"in t&&n(5,c=t.fieldID),"tileID"in t&&n(6,u=t.tileID)},t.$$.update=()=>{if(246&t.$$.dirty)if(a){const t=window.links[a];n(1,d=t?[t.options.data.oGuid,t.options.data.dGuid]:[])}else if(c){const t=window.fields[c];n(1,d=t?t.options.data.points.map((t=>t.guid)):[])}else if(u){const t=i[u];n(1,d=t?t.entities.filter((t=>"p"==t[0])).map((t=>t[1])):[]),n(1,d=d.filter((t=>o[t])))}else n(1,d=Object.keys(o)),d.sort(((t,e)=>o[e].options.timestamp-o[t].options.timestamp))},[l,d,o,s,a,c,u,i,t=>[t,o[t]?o[t].options.timestamp:0,{name:o[t]&&o[t].options.data.title,team:o[t].options.data.team}],function(e){P.call(this,t,e)}]}class ge extends et{constructor(t){super(),tt(this,t,pe,fe,s,{activeID:0,linkID:4,fieldID:5,tileID:6})}}function $e(t){let e,n,o,i,s,r,l,a,c,u,d,f,p,g,h,v;return o=new Dt({props:{properties:t[2]}}),l=new ge({props:{linkID:t[0]}}),l.$on("select",t[4]),d=new te({props:{linkID:t[0]}}),d.$on("select",t[5]),h=new oe({props:{linkID:t[0]}}),h.$on("select",t[6]),{c(){e=w("h3"),e.textContent="Link",n=I(),X(o.$$.fragment),i=I(),s=w("h3"),s.textContent="Portals",r=I(),X(l.$$.fragment),a=I(),c=w("h3"),c.textContent="Fields",u=I(),X(d.$$.fragment),f=I(),p=w("h3"),p.textContent="Tiles",g=I(),X(h.$$.fragment)},m(t,m){$(t,e,m),$(t,n,m),Q(o,t,m),$(t,i,m),$(t,s,m),$(t,r,m),Q(l,t,m),$(t,a,m),$(t,c,m),$(t,u,m),Q(d,t,m),$(t,f,m),$(t,p,m),$(t,g,m),Q(h,t,m),v=!0},p(t,e){const n={};4&e&&(n.properties=t[2]),o.$set(n);const i={};1&e&&(i.linkID=t[0]),l.$set(i);const s={};1&e&&(s.linkID=t[0]),d.$set(s);const r={};1&e&&(r.linkID=t[0]),h.$set(r)},i(t){v||(Y(o.$$.fragment,t),Y(l.$$.fragment,t),Y(d.$$.fragment,t),Y(h.$$.fragment,t),v=!0)},o(t){Z(o.$$.fragment,t),Z(l.$$.fragment,t),Z(d.$$.fragment,t),Z(h.$$.fragment,t),v=!1},d(t){t&&m(e),t&&m(n),K(o,t),t&&m(i),t&&m(s),t&&m(r),K(l,t),t&&m(a),t&&m(c),t&&m(u),K(d,t),t&&m(f),t&&m(p),t&&m(g),K(h,t)}}}function me(t){let e,n,o=t[1]&&$e(t);return{c(){e=w("div"),o&&o.c()},m(t,i){$(t,e,i),o&&o.m(e,null),n=!0},p(t,[n]){t[1]?o?(o.p(t,n),2&n&&Y(o,1)):(o=$e(t),o.c(),Y(o,1),o.m(e,null)):o&&(B(),Z(o,1,1,(()=>{o=null})),W())},i(t){n||(Y(o),n=!0)},o(t){Z(o),n=!1},d(t){t&&m(e),o&&o.d()}}}function he(t){const[e,n]=t.getLatLngs();return window.map.distance(e,n)}function we(t,e,n){let o,i;r(t,ct,(t=>n(3,i=t)));let{guid:s=null}=e,l=null;return t.$$set=t=>{"guid"in t&&n(0,s=t.guid)},t.$$.update=()=>{9&t.$$.dirty&&(s&&i[s]?n(1,l=i[s]):n(1,l=null)),2&t.$$.dirty&&n(2,o=l?{guid:l.options.guid,timestamp:At(l.options.timestamp),team:l.options.data.team,oGuid:l.options.data.oGuid,oLatE6:l.options.data.oLatE6,oLngE6:l.options.data.oLngE6,dGuid:l.options.data.dGuid,dLatE6:l.options.data.dLatE6,dLngE6:l.options.data.dLngE6,length:he(l)}:{})},[s,l,o,i,function(e){P.call(this,t,e)},function(e){P.call(this,t,e)},function(e){P.call(this,t,e)}]}class ve extends et{constructor(t){super(),tt(this,t,we,me,s,{guid:0})}}function Ie(t){let e,n,o,i,s,r,l,a,c,u,d,f,p,g,h,v;return o=new Dt({props:{properties:t[2]}}),l=new ge({props:{fieldID:t[0]}}),l.$on("select",t[4]),d=new Qt({props:{fieldID:t[0]}}),d.$on("select",t[5]),h=new oe({props:{fieldID:t[0]}}),h.$on("select",t[6]),{c(){e=w("h3"),e.textContent="Field",n=I(),X(o.$$.fragment),i=I(),s=w("h3"),s.textContent="Portals",r=I(),X(l.$$.fragment),a=I(),c=w("h3"),c.textContent="Links",u=I(),X(d.$$.fragment),f=I(),p=w("h3"),p.textContent="Tiles",g=I(),X(h.$$.fragment)},m(t,m){$(t,e,m),$(t,n,m),Q(o,t,m),$(t,i,m),$(t,s,m),$(t,r,m),Q(l,t,m),$(t,a,m),$(t,c,m),$(t,u,m),Q(d,t,m),$(t,f,m),$(t,p,m),$(t,g,m),Q(h,t,m),v=!0},p(t,e){const n={};4&e&&(n.properties=t[2]),o.$set(n);const i={};1&e&&(i.fieldID=t[0]),l.$set(i);const s={};1&e&&(s.fieldID=t[0]),d.$set(s);const r={};1&e&&(r.fieldID=t[0]),h.$set(r)},i(t){v||(Y(o.$$.fragment,t),Y(l.$$.fragment,t),Y(d.$$.fragment,t),Y(h.$$.fragment,t),v=!0)},o(t){Z(o.$$.fragment,t),Z(l.$$.fragment,t),Z(d.$$.fragment,t),Z(h.$$.fragment,t),v=!1},d(t){t&&m(e),t&&m(n),K(o,t),t&&m(i),t&&m(s),t&&m(r),K(l,t),t&&m(a),t&&m(c),t&&m(u),K(d,t),t&&m(f),t&&m(p),t&&m(g),K(h,t)}}}function xe(t){let e,n,o=t[1]&&Ie(t);return{c(){e=w("div"),o&&o.c()},m(t,i){$(t,e,i),o&&o.m(e,null),n=!0},p(t,[n]){t[1]?o?(o.p(t,n),2&n&&Y(o,1)):(o=Ie(t),o.c(),Y(o,1),o.m(e,null)):o&&(B(),Z(o,1,1,(()=>{o=null})),W())},i(t){n||(Y(o),n=!0)},o(t){Z(o),n=!1},d(t){t&&m(e),o&&o.d()}}}function De(t,e,n){let o,i;r(t,ut,(t=>n(3,i=t)));let{guid:s=null}=e,l=null;return t.$$set=t=>{"guid"in t&&n(0,s=t.guid)},t.$$.update=()=>{9&t.$$.dirty&&(s&&i[s]?n(1,l=i[s]):n(1,l=null)),2&t.$$.dirty&&n(2,o=l?{guid:l.options.guid,timestamp:At(l.options.timestamp),team:l.options.data.team,"points[0].guid":l.options.data.points[0].guid,"points[0].latE6":l.options.data.points[0].latE6,"points[0].lngE6":l.options.data.points[0].lngE6,"points[1].guid":l.options.data.points[1].guid,"points[1].latE6":l.options.data.points[1].latE6,"points[1].lngE6":l.options.data.points[1].lngE6,"points[2].guid":l.options.data.points[2].guid,"points[2].latE6":l.options.data.points[2].latE6,"points[2].lngE6":l.options.data.points[2].lngE6}:{})},[s,l,o,i,function(e){P.call(this,t,e)},function(e){P.call(this,t,e)},function(e){P.call(this,t,e)}]}class be extends et{constructor(t){super(),tt(this,t,De,xe,s,{guid:0})}}function ye(t){let e,n,o,i,s,r,l,a,c,u,d,f,p,g,h,v;return o=new Dt({props:{properties:t[2]}}),l=new ge({props:{tileID:t[0]}}),l.$on("select",t[4]),d=new Qt({props:{tileID:t[0]}}),d.$on("select",t[5]),h=new te({props:{tileID:t[0]}}),h.$on("select",t[6]),{c(){e=w("h3"),e.textContent="Tile",n=I(),X(o.$$.fragment),i=I(),s=w("h3"),s.textContent="Portals",r=I(),X(l.$$.fragment),a=I(),c=w("h3"),c.textContent="Links",u=I(),X(d.$$.fragment),f=I(),p=w("h3"),p.textContent="Fields",g=I(),X(h.$$.fragment)},m(t,m){$(t,e,m),$(t,n,m),Q(o,t,m),$(t,i,m),$(t,s,m),$(t,r,m),Q(l,t,m),$(t,a,m),$(t,c,m),$(t,u,m),Q(d,t,m),$(t,f,m),$(t,p,m),$(t,g,m),Q(h,t,m),v=!0},p(t,e){const n={};4&e&&(n.properties=t[2]),o.$set(n);const i={};1&e&&(i.tileID=t[0]),l.$set(i);const s={};1&e&&(s.tileID=t[0]),d.$set(s);const r={};1&e&&(r.tileID=t[0]),h.$set(r)},i(t){v||(Y(o.$$.fragment,t),Y(l.$$.fragment,t),Y(d.$$.fragment,t),Y(h.$$.fragment,t),v=!0)},o(t){Z(o.$$.fragment,t),Z(l.$$.fragment,t),Z(d.$$.fragment,t),Z(h.$$.fragment,t),v=!1},d(t){t&&m(e),t&&m(n),K(o,t),t&&m(i),t&&m(s),t&&m(r),K(l,t),t&&m(a),t&&m(c),t&&m(u),K(d,t),t&&m(f),t&&m(p),t&&m(g),K(h,t)}}}function ke(t){let e,n,o=t[1]&&ye(t);return{c(){e=w("div"),o&&o.c()},m(t,i){$(t,e,i),o&&o.m(e,null),n=!0},p(t,[n]){t[1]?o?(o.p(t,n),2&n&&Y(o,1)):(o=ye(t),o.c(),Y(o,1),o.m(e,null)):o&&(B(),Z(o,1,1,(()=>{o=null})),W())},i(t){n||(Y(o),n=!0)},o(t){Z(o),n=!1},d(t){t&&m(e),o&&o.d()}}}function Le(t,e,n){let o;r(t,dt,(t=>n(3,o=t)));let{tid:i=null}=e,s=null,l={};return t.$$set=t=>{"tid"in t&&n(0,i=t.tid)},t.$$.update=()=>{if(9&t.$$.dirty&&n(1,s=i?o[i]:null),3&t.$$.dirty)if(s){const[t,e,o,r,a,c]=i.split("_");n(2,l={id:i,time:At(s.time),zoom:t,x:e,y:o,minlvl:r,maxlvl:a,maxhealth:c})}else n(2,l={})},[i,s,l,o,function(e){P.call(this,t,e)},function(e){P.call(this,t,e)},function(e){P.call(this,t,e)}]}class Ee extends et{constructor(t){super(),tt(this,t,Le,ke,s,{tid:0})}}function Ce(t){g(t,"svelte-ax0e4s",".content.svelte-ax0e4s.svelte-ax0e4s{display:grid;grid-gap:24px;grid-auto-flow:column}.tablist.svelte-ax0e4s.svelte-ax0e4s{padding-left:1em}.tablist.svelte-ax0e4s li.svelte-ax0e4s{display:inline-block}.tablist.svelte-ax0e4s li.active.svelte-ax0e4s{font-weight:bold}.tablist.svelte-ax0e4s li.selected.svelte-ax0e4s{color:red;font-weight:bold}.tablist.svelte-ax0e4s li.svelte-ax0e4s:nth-child(n + 2)::before{content:'| '}.content.svelte-ax0e4s>div.svelte-ax0e4s{background-color:#0003;border-radius:10px;padding:0.5em}@media(max-width: 700px){.content.svelte-ax0e4s>div.svelte-ax0e4s{box-sizing:border-box;width:calc(100vw - 24px)}}")}function Se(t){let e,n,o;return{c(){e=w("li"),e.textContent="Current portal",D(e,"class","svelte-ax0e4s"),L(e,"selected","portal"==t[0]&&t[1]==t[3])},m(i,s){$(i,e,s),n||(o=x(e,"click",t[5]),n=!0)},p(t,n){11&n&&L(e,"selected","portal"==t[0]&&t[1]==t[3])},d(t){t&&m(e),n=!1,o()}}}function Te(t){let e,n;return e=new oe({props:{activeID:"tile"==t[0]&&t[1]}}),e.$on("select",t[4]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};3&n&&(o.activeID="tile"==t[0]&&t[1]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Fe(t){let e,n;return e=new te({props:{activeID:"field"==t[0]&&t[1]}}),e.$on("select",t[4]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};3&n&&(o.activeID="field"==t[0]&&t[1]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Pe(t){let e,n;return e=new Qt({props:{activeID:"link"==t[0]&&t[1]}}),e.$on("select",t[4]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};3&n&&(o.activeID="link"==t[0]&&t[1]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function _e(t){let e,n;return e=new ge({props:{activeID:"portal"==t[0]&&t[1]}}),e.$on("select",t[4]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};3&n&&(o.activeID="portal"==t[0]&&t[1]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function je(t){let e,n,o,i;const s=[Ge,Ne,ze,Me],r=[];function l(t,e){return"portal"==t[0]?0:"link"==t[0]?1:"field"==t[0]?2:"tile"==t[0]?3:-1}return~(n=l(t))&&(o=r[n]=s[n](t)),{c(){e=w("div"),o&&o.c(),D(e,"class","card svelte-ax0e4s")},m(t,o){$(t,e,o),~n&&r[n].m(e,null),i=!0},p(t,i){let a=n;n=l(t),n===a?~n&&r[n].p(t,i):(o&&(B(),Z(r[a],1,1,(()=>{r[a]=null})),W()),~n?(o=r[n],o?o.p(t,i):(o=r[n]=s[n](t),o.c()),Y(o,1),o.m(e,null)):o=null)},i(t){i||(Y(o),i=!0)},o(t){Z(o),i=!1},d(t){t&&m(e),~n&&r[n].d()}}}function Me(t){let e,n;return e=new Ee({props:{tid:t[1]}}),e.$on("select",t[4]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.tid=t[1]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function ze(t){let e,n;return e=new be({props:{guid:t[1]}}),e.$on("select",t[4]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.guid=t[1]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Ne(t){let e,n;return e=new ve({props:{guid:t[1]}}),e.$on("select",t[4]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.guid=t[1]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Ge(t){let e,n;return e=new de({props:{guid:t[1]}}),e.$on("select",t[4]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.guid=t[1]),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function qe(t){let e,n,i,s,r,l,a,c,u,d,f,g,h,v,b,y,k,E,C=t[3]&&Se(t);const S=[_e,Pe,Fe,Te],T=[];function F(t,e){return"portals"==t[2]?0:"links"==t[2]?1:"fields"==t[2]?2:"tiles"==t[2]?3:-1}~(h=F(t))&&(v=T[h]=S[h](t));let P=t[0]&&je(t);return{c(){e=w("div"),n=w("div"),i=w("ul"),s=w("li"),s.textContent="Portals",r=I(),l=w("li"),l.textContent="Links",a=I(),c=w("li"),c.textContent="Fields",u=I(),d=w("li"),d.textContent="Tiles",f=I(),C&&C.c(),g=I(),v&&v.c(),b=I(),P&&P.c(),D(s,"class","svelte-ax0e4s"),L(s,"active","portals"==t[2]),D(l,"class","svelte-ax0e4s"),L(l,"active","links"==t[2]),D(c,"class","svelte-ax0e4s"),L(c,"active","fields"==t[2]),D(d,"class","svelte-ax0e4s"),L(d,"active","tiles"==t[2]),D(i,"class","tablist svelte-ax0e4s"),D(n,"class","list svelte-ax0e4s"),D(e,"class","content svelte-ax0e4s")},m(o,m){$(o,e,m),p(e,n),p(n,i),p(i,s),p(i,r),p(i,l),p(i,a),p(i,c),p(i,u),p(i,d),p(i,f),C&&C.m(i,null),p(n,g),~h&&T[h].m(n,null),p(e,b),P&&P.m(e,null),y=!0,k||(E=[x(s,"click",t[6]),x(l,"click",t[7]),x(c,"click",t[8]),x(d,"click",t[9])],k=!0)},p(t,o){(!y||4&o)&&L(s,"active","portals"==t[2]),(!y||4&o)&&L(l,"active","links"==t[2]),(!y||4&o)&&L(c,"active","fields"==t[2]),(!y||4&o)&&L(d,"active","tiles"==t[2]),t[3]?C?C.p(t,o):(C=Se(t),C.c(),C.m(i,null)):C&&(C.d(1),C=null);let r=h;h=F(t),h===r?~h&&T[h].p(t,o):(v&&(B(),Z(T[r],1,1,(()=>{T[r]=null})),W()),~h?(v=T[h],v?v.p(t,o):(v=T[h]=S[h](t),v.c()),Y(v,1),v.m(n,null)):v=null),t[0]?P?(P.p(t,o),1&o&&Y(P,1)):(P=je(t),P.c(),Y(P,1),P.m(e,null)):P&&(B(),Z(P,1,1,(()=>{P=null})),W())},i(t){y||(Y(v),Y(P),y=!0)},o(t){Z(v),Z(P),y=!1},d(t){t&&m(e),C&&C.d(),~h&&T[h].d(),P&&P.d(),k=!1,o(E)}}}function Re(t){let e,n;return e=new st({props:{options:{title:"Data Explorer",resizable:!0,width:"auto",dialogClass:"full-width-dialog"},$$slots:{default:[qe]},$$scope:{ctx:t}}}),e.$on("close",t[10]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,[n]){const o={};32783&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Ae(t,e,n){let o,i;r(t,dt,(t=>n(12,o=t))),r(t,ft,(t=>n(3,i=t)));let s=null,l=null,a=window.L.featureGroup().addTo(window.map),c=[];function u(t){a.clearLayers(),c=t;for(const t of c){const[e,n]=t;switch(e){case"p":break;case"e":const t=window.links[n];t&&window.L.geodesicPolyline(t.getLatLngs(),{color:"red",interactive:!1}).addTo(a);break;case"r":const e=window.fields[n];e&&window.L.geodesicPolygon(e.getLatLngs(),{stroke:!1,fillColor:"red",interactive:!1}).addTo(a)}}a.bringToFront()}let d="portals";T((()=>{u([]),a.remove()}));return[s,l,d,i,function(t){if(a.clearLayers(),t.detail){switch(n(0,s=t.detail.type),n(1,l=t.detail.guid),s){case"portal":window.selectPortal(l);break;case"link":u([["e",l]]);for(const t of function(t){const e=window.links[t];if(!e)return[];const n=e.getLatLngs(),o=window.map.distance(n[0],n[1]),i=[[300,14],[800,13],[2500,11],[5e3,10],[1e4,9],[6e4,7],[2e5,5],[12e6,4]].find((t=>t[0]>o))[1];return(new Nt).getCovering(new Mt(n.map(bt)),i)}(l))window.L.geodesicPolygon(t.getCornerLatLngs(),{color:"yellow",fill:!1,interactive:!1}).addTo(a);break;case"field":u([["r",l]]);for(const t of function(t){const e=window.fields[t];if(!e)return[];const[n,o,i]=e.getLatLngs(),s=Math.max(window.map.distance(n,o),window.map.distance(o,i),window.map.distance(i,n)),r=[[300,14],[800,13],[2500,11],[5e3,10],[1e4,9],[6e4,7],[2e5,5],[12e6,4]].find((t=>t[0]>s))[1];return(new Nt).getCovering(new zt(bt(n),bt(o),bt(i)),r)}(l))window.L.geodesicPolygon(t.getCornerLatLngs(),{color:"yellow",fill:!1,interactive:!1}).addTo(a);break;case"tile":const t=Jt(l),e=o[l];e&&u(e.entities),window.L.rectangle([[t.latSouth,t.lngWest],[t.latNorth,t.lngEast]],{color:"purple",interactive:!1}).addTo(a);for(const t of function(t){const e=Jt(t),n=window.L.latLngBounds([e.latSouth,e.lngWest],[e.latNorth,e.lngEast]).pad(.01),o=[4,4,4,4,4,5,5,7,9,10,10,11,13,14,14,14],i={};for(let t=3;t<=e.zoom&&t<=15;t++){const e=o[t];if(e in i)continue;const s=[Gt.FromLatLng(n.getSouthEast(),e),Gt.FromLatLng(n.getSouthWest(),e),Gt.FromLatLng(n.getNorthEast(),e),Gt.FromLatLng(n.getNorthWest(),e)];i[e]={[s[0].toString()]:s[0],[s[1].toString()]:s[1],[s[2].toString()]:s[2],[s[3].toString()]:s[3]}}const s=[];for(const t in i)for(const e in i[t])s.push(i[t][e]);const r=[],l={};for(const t of s)l[t.toString()]=!0,r.push(t);for(;r.length;){const t=r.pop();for(const e of t.getNeighbors())e.toString()in l||(l[e.toString()]=!0,e.getCornerLatLngs().some((t=>n.contains(t)))&&(s.push(e),r.push(e)))}return s}(l))window.L.geodesicPolygon(t.getCornerLatLngs(),{color:"yellow",fill:!1}).addTo(a)}a.bringToFront()}else n(1,l=null),n(0,s=null)},function(){window.selectedPortal&&(n(0,s="portal"),n(1,l=window.selectedPortal))},()=>n(2,d="portals"),()=>n(2,d="links"),()=>n(2,d="fields"),()=>n(2,d="tiles"),function(e){P.call(this,t,e)}]}class Je extends et{constructor(t){super(),tt(this,t,Ae,Re,s,{},Ce)}}function Oe(t){g(t,"svelte-13sakq4",".content.svelte-13sakq4.svelte-13sakq4{display:grid}.content.svelte-13sakq4>div.svelte-13sakq4{background-color:#0003;border-radius:10px;padding:0.5em}@media(max-width: 700px){.content.svelte-13sakq4>div.svelte-13sakq4{box-sizing:border-box;width:calc(100vw - 24px)}}")}function He(t){let e,n,i,s,r,l,a,c,u,d,f,g,h,v,y,L,E,C,S,T,F,P,_;return T=new te({props:{activeID:t[0]}}),T.$on("select",t[6]),{c(){e=w("div"),n=w("div"),i=w("table"),s=w("tr"),s.innerHTML="<th>Min lvl</th><th>Max lvl</th><th>#Cells</th><th>Merge</th>",r=I(),l=w("tr"),a=w("td"),c=w("input"),u=I(),d=w("td"),f=w("input"),g=I(),h=w("td"),v=w("input"),y=I(),L=w("td"),E=w("input"),C=I(),S=w("div"),X(T.$$.fragment),D(c,"type","number"),D(f,"type","number"),D(v,"type","number"),D(E,"type","checkbox"),D(n,"class","options svelte-13sakq4"),D(S,"class","list svelte-13sakq4"),D(e,"class","content svelte-13sakq4")},m(o,m){$(o,e,m),p(e,n),p(n,i),p(i,s),p(i,r),p(i,l),p(l,a),p(a,c),k(c,t[1]),p(l,u),p(l,d),p(d,f),k(f,t[2]),p(l,g),p(l,h),p(h,v),k(v,t[3]),p(l,y),p(l,L),p(L,E),E.checked=t[4],p(e,C),p(e,S),Q(T,S,null),F=!0,P||(_=[x(c,"input",t[7]),x(c,"change",t[5]),x(f,"input",t[8]),x(f,"change",t[5]),x(v,"input",t[9]),x(v,"change",t[5]),x(E,"change",t[10]),x(E,"change",t[5])],P=!0)},p(t,e){2&e&&b(c.value)!==t[1]&&k(c,t[1]),4&e&&b(f.value)!==t[2]&&k(f,t[2]),8&e&&b(v.value)!==t[3]&&k(v,t[3]),16&e&&(E.checked=t[4]);const n={};1&e&&(n.activeID=t[0]),T.$set(n)},i(t){F||(Y(T.$$.fragment,t),F=!0)},o(t){Z(T.$$.fragment,t),F=!1},d(t){t&&m(e),K(T),P=!1,o(_)}}}function Ue(t){let e,n;return e=new st({props:{options:{title:"Field Covering",resizable:!0,width:"auto"},$$slots:{default:[He]},$$scope:{ctx:t}}}),e.$on("close",t[11]),{c(){X(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},p(t,[n]){const o={};8223&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){Z(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function Be(t,e,n){let o=null,i=4,s=13,r=1e3,l=!0,a=window.L.featureGroup().addTo(window.map);function c(){a.clearLayers();const t=window.fields[o];if(t){window.L.geodesicPolygon(t.getLatLngs(),{color:"red",interactive:!1}).addTo(a);for(const t of function(t,e=4,n=13,o=1e3,i=!0){const s=window.fields[t];if(!s)return[];const[r,l,a]=s.getLatLngs(),c=new zt(bt(r),bt(l),bt(a)),u=(new Nt).getCovering(c,e),d=[];if(0==u.length)return[];for(;u.length&&u[0].level<=n&&u.length<o;){const t=u.shift();if(t.level>=n||t.getCornerXYZ().every((t=>c.containsPoint(t))))for(d.push(t),o--;i&&d.length>=4;){const t=d[d.length-1].getParent(),e=t.toString();if(d[d.length-2].getParent().toString()!==e||d[d.length-3].getParent().toString()!==e||d[d.length-4].getParent().toString()!==e)break;d.splice(d.length-4,4,t),o+=3}else{const e=t.getChildren().filter((t=>c.mayIntersect(t)));u.push(...e)}}return u.concat(d)}(o,i,s,r,l))window.L.geodesicPolygon(t.getCornerLatLngs(),{color:"purple",interactive:!1}).addTo(a)}a.bringToFront()}return T((()=>{a.clearLayers(),a.remove()})),[o,i,s,r,l,c,function(t){if(a.clearLayers(),t.detail){if("field"===t.detail.type)n(0,o=t.detail.guid),c();a.bringToFront()}else n(0,o=null)},function(){i=b(this.value),n(1,i)},function(){s=b(this.value),n(2,s)},function(){r=b(this.value),n(3,r)},function(){l=this.checked,n(4,l)},function(e){P.call(this,t,e)}]}class We extends et{constructor(t){super(),tt(this,t,Be,Ue,s,{},Oe)}}function Ye(e){let n,i,s,r,l;return{c(){n=w("a"),n.textContent="DataExplorer",i=I(),s=w("a"),s.textContent="FieldCovering"},m(t,o){$(t,n,o),$(t,i,o),$(t,s,o),r||(l=[x(n,"click",e[0]),x(s,"click",e[1])],r=!0)},p:t,i:t,o:t,d(t){t&&m(n),t&&m(i),t&&m(s),r=!1,o(l)}}}function Ze(t,e,n){let o,i,s,l,a;r(t,dt,(t=>n(3,o=t))),r(t,ft,(t=>n(4,i=t))),r(t,ut,(t=>n(5,s=t))),r(t,ct,(t=>n(6,l=t))),r(t,at,(t=>n(7,a=t))),f(at,a=window.portals,a),f(ct,l=window.links,l),f(ut,s=window.fields,s),f(ft,i=window.selectedPortal,i),window.addHook("mapDataRefreshEnd",(()=>{f(at,a=window.portals,a),f(ct,l=window.links,l),f(ut,s=window.fields,s)})),window.addHook("portalAdded",(t=>{f(at,a[t.portal.options.guid]=t.portal,a)})),window.addHook("linkAdded",(t=>{f(ct,l[t.link.options.guid]=t.link,l)})),window.addHook("fieldAdded",(t=>{f(ut,s[t.field.options.guid]=t.field,s)})),window.addHook("portalSelected",(t=>{f(ft,i=t.selectedPortalGuid,i)}));let c=0;window.addHook("mapDataRefreshStart",(()=>{c=Date.now()})),window.addHook("mapDataRefreshEnd",(()=>{const t=o,e=[],n=c-6e5;for(const o in t)t[o].time<n&&e.push(o);for(const n of e)delete t[n];f(dt,o=t,o)}));const u=window.MapDataRequest.prototype.pushRenderQueue;return window.MapDataRequest.prototype.pushRenderQueue=function(t,e,n){u.call(this,t,e,n),f(dt,o[t]={time:Date.now(),entities:e.gameEntities.map((t=>[t[2][0],t[0]]))},o)},[function(){const t=new Je({target:document.body});t.$on("close",(()=>t.$destroy()))},function(){const t=new We({target:document.body});t.$on("close",(()=>t.$destroy()))}]}class Xe extends et{constructor(t){super(),tt(this,t,Ze,Ye,s,{})}}const Qe="dataExplorer";class Ke{init(){const t=document.querySelector("#toolbox");new Xe({target:t})}}return()=>{window.plugin[Qe]=new Ke,window.plugin[Qe].init()}}();
if(!window.bootPlugins) window.bootPlugins = [];
window.bootPlugins.push(setup);
// if IITC has already booted, immediately run the 'setup' function
if(window.iitcLoaded && typeof setup === 'function') setup();
setup.info = { 
  script: { 
    version: "0.1.17", 
    name: "IITC plugin: Data Explorer", 
    description: "UI to explore intel available data" 
  }
};
}

var script = document.createElement('script');
// if on last IITC mobile, will be replaced by wrapper(info)
var mobile = `script.appendChild(document.createTextNode('('+ wrapper +')('+JSON.stringify(info)+');'));
(document.body || document.head || document.documentElement).appendChild(script);`;
// detect if mobile
if (mobile.startsWith('script')) {
  script.appendChild(document.createTextNode('('+ wrapper +')();'));
  script.appendChild(document.createTextNode('//# sourceURL=iitc:///plugins/dataExplorer.js'));
  (document.body || document.head || document.documentElement).appendChild(script);
} else {
  // mobile string
  wrapper();
}
